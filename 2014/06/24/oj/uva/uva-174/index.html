<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="/img/f.png">
  
  <title>UVa 174 - Strategy | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Problem
A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one">
<meta property="og:type" content="article">
<meta property="og:title" content="UVa 174 - Strategy">
<meta property="og:url" content="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/">
<meta property="og:site_name" content="Morris' Blog">
<meta property="og:description" content="Problem
A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UVa 174 - Strategy">
<meta name="twitter:description" content="Problem
A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one">
<link rel="publisher" href="108158678174364350000">

  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
  <!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Can you find me ?</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main"><article id="post-oj/uva/uva-174" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-174/" class="article-date">
  <time datetime="2014-06-24T09:17:39.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      UVa 174 - Strategy
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/" data-id="zapgd8enysh6kvcm" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞迴分析/">遞迴分析</a></li></ul>

    </footer>
    <div class="article-entry " itemprop="articleBody">
      
          
        
          <h2 id="Problem">Problem</h2>
<p>A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one point. If one TRADEs and the other CHEATs then the TRADEr loses 2 points and the CHEATer wins 2. If both CHEAT then each loses 1 point.</p>
<p>There are a variety of different strategies for playing this game, although most people are either unable to find a winning strategy, or, having decided on a strategy, do not stick to it. Thus it is fairer to attempt to evaluate these strategies by simulation on a computer. Each strategy is simulated by an automaton. An automaton is characterised by a program incorporating the strategy, a memory for previous encounters and a count reflecting the score of that automaton. The count starts at zero and is altered according to the above rules after each encounter. The memory is able to determine what happened on up to the last two encounters with each other contender.</p>
<p>Write a program that will read in details of up to 10 different strategies, play each strategy against each other strategy 10 times and then print out the final scores. Strategies will be in the form of simple programs obeying the following grammar:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">program</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">statement</span>&gt;</span>.</div><div class="line"><span class="tag">&lt;<span class="title">statement</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">command</span>&gt;</span> tex2html_wrap_inline45 <span class="tag">&lt;<span class="title">ifstat</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">ifstat</span>&gt;</span> ::= IF <span class="tag">&lt;<span class="title">condition</span>&gt;</span> THEN <span class="tag">&lt;<span class="title">statement</span>&gt;</span> ELSE <span class="tag">&lt;<span class="title">statement</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">condition</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">cond</span>&gt;</span> tex2html_wrap_inline45 <span class="tag">&lt;<span class="title">cond</span>&gt;</span> <span class="tag">&lt;<span class="title">op</span>&gt;</span> <span class="tag">&lt;<span class="title">condition</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">op</span>&gt;</span> ::= AND tex2html_wrap_inline45 OR</div><div class="line"><span class="tag">&lt;<span class="title">cond</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">memory</span>&gt;</span> {= tex2html_wrap_inline45 #} {<span class="tag">&lt;<span class="title">command</span>&gt;</span> tex2html_wrap_inline45 NULL}</div><div class="line"><span class="tag">&lt;<span class="title">memory</span>&gt;</span> ::= {MY tex2html_wrap_inline45 YOUR} LAST {1 tex2html_wrap_inline45 2}</div><div class="line"><span class="tag">&lt;<span class="title">command</span>&gt;</span> ::= TRADE tex2html_wrap_inline45 CHEAT</div></pre></td></tr></table></figure>

<p>Note that LAST1 refers to the previous encounter between these two automata, LAST2 to the encounter before that and that <code>MY&#39; and</code>YOUR’ have the obvious meanings. Spaces and line breaks may appear anywhere in the program and are for legibility only. The symbol <code>#&#39; means</code>is not equal to’. NULL indicates that an encounter has not ocurred. The following are valid programs:</p>
<p>CHEAT.<br>IF MY LAST1 = CHEAT THEN TRADE ELSE CHEAT.<br>IFYOURLAST2=NULLTHENTRADEELSEIFYOURLAST1=TRADETHENTRADE<br>ELSECHEAT.</p>
<h2 id="Input">Input</h2>
<p>Input will consist of a series of programs. Each program will be no longer than 255 characters and may be split over several lines for convenience. There will be no more than 10 programs. The file will be terminated by a line containing only a single `#’.</p>
<h2 id="Output">Output</h2>
<p>Output will consist of one line for each line of input. Each line will consist of the final score of the relevant program right justified in a field of width 3.</p>
<h2 id="Sample_input">Sample input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CHEAT.</div><div class="line">IF MY <span class="variable">LAST1 =</span> CHEAT THEN TRADE ELSE CHEAT.</div><div class="line"><span class="variable">IFYOURLAST2=</span><span class="variable">NULLTHENTRADEELSEIFYOURLAST1=</span>TRADETHENTRADE</div><div class="line">ELSECHEAT.</div><div class="line"><span class="comment">#</span></div></pre></td></tr></table></figure>

<h2 id="Sample_output">Sample output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  1</div><div class="line">-<span class="ruby"><span class="number">12</span></span></div><div class="line">-<span class="ruby"><span class="number">13</span></span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>現在這邊有兩台機器人，玩類似 “吹牛” 的紙牌遊戲，欺騙成功者將獲得點數。</p>
<p>而每一台機器的策略也有所不同，並且能根據對方前幾次和自己前幾次的策略進行判斷，給予每一台機器的策略模式，請兩兩互打 10 回合，最後輸出每一台機器的得分概況。</p>
<p><strong> 題目解法： </strong></p>
<p>這題不只有語法分析，還有語意分析。總之，遞迴分析是最主要的技巧。<br>對於 AND 和 OR 運算，測資中似乎沒有優先順序的情況，所以直接由左而右進行即可。</p>
<p>而在分析的時候，嘗試將指針一直往後移動，並且解析出第一個符合條件的 token。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;assert.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;ctype.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">enum</span> ACTION {TRADE, CHEAT, EMPTY};</div><div class="line"><span class="keyword">enum</span> RECORD {LAST1, LAST2};</div><div class="line"><span class="keyword">class</span> Memory {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="stl_container"><span class="built_in">map</span>&lt;RECORD, ACTION&gt;</span> R;</div><div class="line">    Memory() {</div><div class="line">        R[LAST1] = EMPTY;</div><div class="line">        R[LAST2] = EMPTY;</div><div class="line">    }</div><div class="line">    <span class="keyword">static</span> ACTION getAction(<span class="built_in">string</span> s) {</div><div class="line">        <span class="keyword">if</span>(s == <span class="string">"TRADE"</span>)    <span class="keyword">return</span> TRADE;</div><div class="line">        <span class="keyword">if</span>(s == <span class="string">"CHEAT"</span>)    <span class="keyword">return</span> CHEAT;</div><div class="line">        <span class="keyword">if</span>(s == <span class="string">"EMPTY"</span>)    <span class="keyword">return</span> EMPTY;</div><div class="line">        assert(<span class="keyword">false</span>);</div><div class="line">    }</div><div class="line">    ACTION getMemory(<span class="built_in">string</span> addr) {</div><div class="line">        <span class="keyword">if</span> (addr == <span class="string">"LAST1"</span>)</div><div class="line">            <span class="keyword">return</span> R[LAST1];</div><div class="line">        <span class="keyword">if</span> (addr == <span class="string">"LAST2"</span>)</div><div class="line">            <span class="keyword">return</span> R[LAST2];</div><div class="line">        assert(<span class="keyword">false</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">void</span> record(ACTION a) {</div><div class="line">        ACTION last1 = R[LAST1], last2 = R[LAST2];</div><div class="line">        R[LAST1] = a;</div><div class="line">        R[LAST2] = last1;</div><div class="line">    }</div><div class="line">};</div><div class="line"><span class="keyword">class</span> Strategy {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">char</span> prog[<span class="number">1024</span>];</div><div class="line">    Strategy(<span class="built_in">string</span> s) {</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) {</div><div class="line">            prog[i] = s[i];</div><div class="line">        }</div><div class="line">        prog[s.length()] = <span class="string">'\0'</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">char</span>* match(<span class="keyword">char</span> *str, <span class="keyword">const</span> <span class="keyword">char</span> *p) {</div><div class="line">        <span class="keyword">if</span> (str == NULL)</div><div class="line">            <span class="keyword">return</span>  NULL;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">memcmp</span>(str, p, <span class="built_in">strlen</span>(p)) == <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> str + <span class="built_in">strlen</span>(p);</div><div class="line">        <span class="keyword">return</span> NULL;</div><div class="line">    }</div><div class="line"><span class="comment">/*</span></div><div class="line"> &lt;condition&gt; ::= &lt;cond&gt; | &lt;cond&gt; &lt;op&gt; &lt;condition&gt;</div><div class="line"> &lt;op&gt; ::= AND | OR</div><div class="line"> &lt;cond&gt; ::= &lt;memory&gt; {= | #} {&lt;command&gt; | NULL}</div><div class="line"> &lt;memory&gt; ::= {MY | YOUR} LAST {1 | 2}</div><div class="line"> &lt;command&gt; ::= TRADE | CHEAT</div><div class="line"> */</div><div class="line">    <span class="keyword">bool</span> cond(<span class="keyword">char</span>* &amp;p, Memory MY, Memory YOUR) {</div><div class="line">        <span class="comment">// printf("condition %s\n", p);</span></div><div class="line">        <span class="keyword">char</span>        *q;</div><div class="line">        Memory      *addr = NULL;</div><div class="line">        <span class="built_in">string</span>      read, equal, kind;</div><div class="line">        <span class="comment">/* &lt;memory&gt; */</span></div><div class="line">        q = match(p, <span class="string">"MY"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, addr = &amp;MY;</div><div class="line">        q = match(p, <span class="string">"YOUR"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, addr = &amp;YOUR;</div><div class="line">        q = match(p, <span class="string">"LAST1"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, read = <span class="string">"LAST1"</span>;</div><div class="line">        q = match(p, <span class="string">"LAST2"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, read = <span class="string">"LAST2"</span>;</div><div class="line">        <span class="comment">/* {= | #} */</span></div><div class="line">        q = match(p, <span class="string">"="</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, equal = <span class="string">"="</span>;</div><div class="line">        q = match(p, <span class="string">"#"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, equal = <span class="string">"#"</span>;</div><div class="line">        <span class="comment">/* {&lt;command&gt; | NULL} */</span></div><div class="line">        q = match(p, <span class="string">"TRADE"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, kind = <span class="string">"TRADE"</span>;</div><div class="line">        q = match(p, <span class="string">"CHEAT"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, kind = <span class="string">"CHEAT"</span>;</div><div class="line">        q = match(p, <span class="string">"NULL"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, kind = <span class="string">"EMPTY"</span>;</div><div class="line">        <span class="keyword">bool</span> ret = equal == <span class="string">"="</span> ? addr-&gt;getMemory(read) == Memory::getAction(kind) :</div><div class="line">									addr-&gt;getMemory(read) != Memory::getAction(kind);</div><div class="line">        <span class="comment">// cout &lt;&lt; "ADDR: " &lt;&lt; addr-&gt;getMemory(read) &lt;&lt; ", ACTION: " &lt;&lt; Memory::getAction(kind) &lt;&lt; endl;</span></div><div class="line">        <span class="comment">// cout &lt;&lt; read &lt;&lt; ", " &lt;&lt; kind &lt;&lt; endl; </span></div><div class="line">        <span class="comment">/* &lt;op&gt; &lt;condition&gt; */</span></div><div class="line">        q = match(p, <span class="string">"AND"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, ret = ret&amp;cond(p, MY, YOUR);</div><div class="line">        q = match(p, <span class="string">"OR"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, ret = ret|cond(p, MY, YOUR);</div><div class="line">        <span class="comment">// cout &lt;&lt; "return " &lt;&lt; ret &lt;&lt; endl;</span></div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    }</div><div class="line">    ACTION ifstat(<span class="keyword">char</span>* &amp;p, Memory a, Memory b) {</div><div class="line">        <span class="keyword">char</span> *q;</div><div class="line">        q = match(p, <span class="string">"IF"</span>);</div><div class="line">        <span class="keyword">if</span> (q != NULL) {</div><div class="line">            p = q;</div><div class="line">            <span class="keyword">bool</span> f = cond(p, a, b);</div><div class="line">            ACTION a1, a2;</div><div class="line">            q = match(p, <span class="string">"THEN"</span>);</div><div class="line">            p = q;</div><div class="line">            a1 = statement(p, a, b);</div><div class="line">            q = match(p, <span class="string">"ELSE"</span>);</div><div class="line">        	p = q;</div><div class="line">        	a2 = statement(p, a, b);</div><div class="line">        	<span class="keyword">return</span> f ? a1 : a2;</div><div class="line">        }</div><div class="line">        assert(<span class="keyword">false</span>);</div><div class="line">    }</div><div class="line">    ACTION statement(<span class="keyword">char</span>* &amp;p, Memory a, Memory b) {</div><div class="line">        <span class="comment">// printf("%s\n", p);</span></div><div class="line">        <span class="keyword">char</span> *q;</div><div class="line">        q = match(p, <span class="string">"TRADE"</span>);</div><div class="line">        <span class="keyword">if</span> (q != NULL)  {</div><div class="line">            p = q;</div><div class="line">            <span class="keyword">return</span> TRADE;</div><div class="line">        }</div><div class="line">        q = match(p, <span class="string">"CHEAT"</span>);</div><div class="line">        <span class="keyword">if</span> (q != NULL) {</div><div class="line">            p = q;</div><div class="line">            <span class="keyword">return</span> CHEAT;</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> ifstat(p, a, b);</div><div class="line">    }</div><div class="line">    ACTION eval(<span class="keyword">char</span>* &amp;p, Memory a, Memory b) { <span class="comment">// read only</span></div><div class="line">        <span class="comment">// printf("eval %s\n", p);</span></div><div class="line">        <span class="keyword">return</span> statement(p, a, b);</div><div class="line">    }</div><div class="line">};</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">    <span class="keyword">char</span> c, s[<span class="number">1024</span>];</div><div class="line">    <span class="stl_container"><span class="built_in">vector</span>&lt;Strategy&gt;</span> machine;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) {</div><div class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> ((c = getchar()) != EOF) {</div><div class="line">            <span class="keyword">if</span>(c == <span class="string">'.'</span> || (c == <span class="string">'#'</span> &amp;&amp; n == <span class="number">0</span>) )</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">if</span>(<span class="built_in">isspace</span>(c))</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            s[n++] = c;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>)</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        s[n++] = <span class="string">'\0'</span>;</div><div class="line">        machine.push_back(Strategy(s));</div><div class="line">    }</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> MAXN 20</span></div><div class="line">    <span class="keyword">int</span> SCORE[MAXN] = {};</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; machine.size(); i++) {</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; machine.size(); j++) {</div><div class="line">            Memory      ma, mb;</div><div class="line">            Strategy    &amp;A = machine[i];</div><div class="line">            Strategy    &amp;B = machine[j];</div><div class="line">            <span class="keyword">char</span>        *p;</div><div class="line">            </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">10</span>; k++) {</div><div class="line">                ACTION ia = A.eval(p = A.prog, ma, mb);</div><div class="line">                ACTION ib = B.eval(p = B.prog, mb, ma);</div><div class="line">                <span class="keyword">if</span>(ia == TRADE &amp;&amp; ib == TRADE)</div><div class="line">                	SCORE[i]++, SCORE[j]++;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ia == TRADE &amp;&amp; ib == CHEAT)</div><div class="line">                	SCORE[i] -= <span class="number">2</span>, SCORE[j] += <span class="number">2</span>;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ia == CHEAT &amp;&amp; ib == TRADE)</div><div class="line">                	SCORE[i] += <span class="number">2</span>, SCORE[j] -= <span class="number">2</span>;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                	SCORE[i]--, SCORE[j]--;</div><div class="line">                ma.record(ia), mb.record(ib);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; machine.size(); i++)</div><div class="line">    	<span class="built_in">printf</span>(<span class="string">"%3d\n"</span>, SCORE[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
        
      
    </div>

  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/06/24/oj/uva/uva-427/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          UVa 427 - FlatLand Piano Movers
        
      </div>
    </a>
  
  
    <a href="/2014/06/24/oj/uva/uva-171/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">UVa 171 - Car Trialling</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
          
            <aside id="sidebar">
  <div id="ukagaka_panel"></div>

  

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">46</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">449</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">409</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2015/04/20/2015-google-code-jam-1A/">
              
                <i class="icon-file-o"></i> 
              
            2015 Google Code Jam Round 1A</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1115/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1115 - Water Shortage</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1089/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1089 - Suffix-Replacement Grammars</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1084/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1084 - Deer-Proof Fence</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1080/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1080 - My Bad</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1078/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1078 - Steam Roller</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1076/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1076 - Password Suspects</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1063/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1063 - Marble Game</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1049/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1049 - Remember the A La Mode</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1048/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1048 - Low Cost Air Travel</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget widget-background1">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮神"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="#" title=""><i class="icon-github-alt"></i> Can you translate world for me ?</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
</aside>

          
            
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://plus.google.com/u/0/108158678174364359204" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2015 Shiang-Yun Yang 
    </div>  

  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/picture" class="mobile-nav-link">Pictures</a>
  
    <a href="/works" class="mobile-nav-link">Works</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  var disqus_url = 'http://morris821028.github.io/2014/06/24/oj/uva/uva-174/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/jquery.lazyload.js" type="text/javascript"></script>

<script src="/js/jquery.als-1.6.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>