<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="/img/f.png">
  
  <title>UVa 12176 - Bring Your Own Horse | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Problem
One of the essential activities of a knight is to compete in tournaments. Frequently, groups of knights gather around the country to compare their skills. On such a typical contest day, everyo">
<meta property="og:type" content="article">
<meta property="og:title" content="UVa 12176 - Bring Your Own Horse">
<meta property="og:url" content="http://morris821028.github.io/2014/07/06/oj/uva/uva-12176/">
<meta property="og:site_name" content="Morris' Blog">
<meta property="og:description" content="Problem
One of the essential activities of a knight is to compete in tournaments. Frequently, groups of knights gather around the country to compare their skills. On such a typical contest day, everyo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UVa 12176 - Bring Your Own Horse">
<meta name="twitter:description" content="Problem
One of the essential activities of a knight is to compete in tournaments. Frequently, groups of knights gather around the country to compare their skills. On such a typical contest day, everyo">
<link rel="publisher" href="108158678174364350000">

  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
  <!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Can you find me ?</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main"><article id="post-oj/uva/uva-12176" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/06/oj/uva/uva-12176/" class="article-date">
  <time datetime="2014-07-06T07:01:15.000Z" itemprop="datePublished">Jul 6 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      UVa 12176 - Bring Your Own Horse
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/07/06/oj/uva/uva-12176/" data-id="m9sdh2w6q9gcmltk" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/07/06/oj/uva/uva-12176/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li></ul>

    </footer>
    <div class="article-entry " itemprop="articleBody">
      
          
        
          <h2 id="Problem">Problem</h2>
<p>One of the essential activities of a knight is to compete in tournaments. Frequently, groups of knights gather around the country to compare their skills. On such a typical contest day, everyone has five hours to do ten disciplines, such as sword fighting, bow and arrow, and various forms of horseback riding. Needless to say, you have to bring your own horse.</p>
<p>This is not as easy as it seems. It often takes a knight several days to go from the castle where he lives to the place where a tournament is held. But horses sometimes are very, very stubborn. After having covered a certain distance on a single day, they sometimes simply stop and refuse to go any further. Luckily, they start anew on the next day. To make sure that the horse does not refuse service before the scheduled day trip is completed, a knight wants to choose an itinerary on which the longest day trip is as short as possible. Hence, a trip that takes many days with short distances is preferable over a shorter route that has the risk of a refusing horse.</p>
<p>Write a program which answers queries from knights spread all over the country about the best way to go from their castles to a tournament site. Given a description of the relevant places (i.e. castles, locations of tournaments, and hostels for overnight stays), the program should tell them the largest distance they have to cover on a single day so that this distance is minimal among all possible itineraries.</p>
<p>The places are designated by consecutive integers from 1 to $ N$, while a road is represented by three integers, namely its place of origin, its destination, and its length. Every road can be used in both directions, and there is at least one route (i.e. a sequence of roads) between any two places. The knights stick to the given roads while travelling and spend their nights only at one of the $ N$ places.</p>
<h2 id="Input">Input</h2>
<p>The first line contains the total number of test cases that follow.</p>
<p>Each test case begins with a line that first holds the number $ N$ of places ( $ 1 \le N \le 3000$ ) followed by the number $ R$ of roads ( $ 1 \le R \le 100000$ ). Then there are $ R$ lines with three integers each ($ a$ , $ b$ , and $ l$ ), each of which defines a road connecting the places $ a$ and $ b$ ( $ 1 \le a, b \le N$ ) with length $ l$ ( $ 1 \le l \le 1000000$ ).</p>
<p>Thereafter, each test case continues with the number $ Q$ of queries on a line by itself ( $ 1 \le Q \le 1000$ ). Each of the next $ Q$ lines holds two integers $ k$ and $ t$ , indicating a query by a knight who lives at place $ k$ and needs to go to a tournament at place $ t$ ( $ 1 \le k, t \le N$ , $ k \neq t$ ).</p>
<h2 id="Output">Output</h2>
<p>For each test case output a line containing the word ``Case’’, a single space, and its serial number (starting with $ 1$ for the first test case). Then, print one line for each query in this test case, containing the smallest maximal day trip distance as described above. Print a blank line after each test case.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">4 4</div><div class="line">1 2 100</div><div class="line">2 3 100</div><div class="line">3 4 100</div><div class="line">4 1 200</div><div class="line">1</div><div class="line">1 4</div><div class="line">6 9</div><div class="line">2 4 5</div><div class="line">5 1 7</div><div class="line">3 6 6</div><div class="line">3 1 4</div><div class="line">2 3 2</div><div class="line">1 2 1</div><div class="line">6 5 42</div><div class="line">4 5 3</div><div class="line">4 6 5</div><div class="line">4</div><div class="line">1 3</div><div class="line">3 4</div><div class="line">5 4</div><div class="line">6 1</div></pre></td></tr></table></figure>



<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Case</span> <span class="number">1</span></div><div class="line"><span class="number">100</span></div><div class="line"></div><div class="line"><span class="keyword">Case</span> <span class="number">2</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">5</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>騎士每天活動只會從該點移動到盡可能短的路徑到下一個點，求從起點到終點之間的最小的最長路為何。</p>
<p><strong> 題目解法： </strong></p>
<p>由於詢問兩個點之間的路徑上的最小值最大邊，不外乎地可以先做一次最小成本樹，根據定義，拆分成 s - t 集合，最小成本樹的邊一定是 s - t 之間的最小邊。</p>
<p>接著詢問在樹上進行即可，因此每次詢問最慘會到 O(n)。</p>
<p>那我們稍微加速，採用 dp 的方式，將樹變成有根樹，記錄每一個節點向上攀升 1 個節點, 2 個節點, 4 個節點 …, 2^n 個節點的路徑上的最大最小值。</p>
<p>因此狀態會是 O(n log n), 建表也能在 O(n log n) 完成，接著調整兩個詢問節點的高度，先想辦法調整到兩個節點到水平高度，藉由之前的計算，高度不超過 n，因此理應可以在 O(log n) 時間內完成到調整到同一水平高度。</p>
<p>在同一水平下，還是需要知道 LCA 的所在高度，否則也可以水平線不斷地一步一步往上提，雖然最慘也許是 O(n) 但是經由之前的調整已經很加速很多。</p>
<p>本來應該套用 LCA Tarjan 的作法來加速，但是還沒有做到這樣的地步速度就很快。如果詢問次數再多一點就必須做到這一步。</p>
<p>有點懶惰 Orz。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">struct</span> E {</div><div class="line">    <span class="keyword">int</span> x, y, v;</div><div class="line">    E(<span class="keyword">int</span> a=<span class="number">0</span>, <span class="keyword">int</span> b=<span class="number">0</span>, <span class="keyword">int</span> c=<span class="number">0</span>):</div><div class="line">        x(a), y(b), v(c) {}</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> E &amp;a) <span class="keyword">const</span> {</div><div class="line">        <span class="keyword">return</span>  v &lt; a.v;</div><div class="line">    }</div><div class="line">};</div><div class="line">E D[<span class="number">100005</span>];</div><div class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;E&gt;</span> tree[<span class="number">3005</span>];</div><div class="line"><span class="keyword">int</span> p[<span class="number">3005</span>], rank[<span class="number">3005</span>];</div><div class="line"><span class="keyword">int</span> findp(<span class="keyword">int</span> x) {</div><div class="line">    <span class="keyword">return</span> p[x] == x ? x : (p[x] = findp(p[x]));</div><div class="line">}</div><div class="line"><span class="keyword">int</span> joint(<span class="keyword">int</span> x, <span class="keyword">int</span> y) {</div><div class="line">    x = findp(x), y = findp(y);</div><div class="line">    <span class="keyword">if</span>(x == y)</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(rank[x] &gt; rank[y])</div><div class="line">        rank[x] += rank[y], p[y] = x;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        rank[y] += rank[x], p[x] = y;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> kruscal(<span class="keyword">int</span> n, <span class="keyword">int</span> m) {</div><div class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">    </div><div class="line">    sort(D, D+m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) {</div><div class="line">        p[i] = i, rank[i] = <span class="number">1</span>;</div><div class="line">        tree[i].clear();</div><div class="line">    }</div><div class="line">    </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">        <span class="keyword">if</span>(joint(D[i].x, D[i].y)) {</div><div class="line">        	sum += D[i].v;</div><div class="line">        	tree[D[i].x].push_back(E(D[i].x, D[i].y, D[i].v));</div><div class="line">        	tree[D[i].y].push_back(E(D[i].y, D[i].x, D[i].v));</div><div class="line"><span class="comment">//        	printf("mmm %d %d %d\n", D[i].x, D[i].y, D[i].v);</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> dp[<span class="number">4096</span>][<span class="number">20</span>], dpw[<span class="number">4096</span>][<span class="number">20</span>];</div><div class="line"><span class="keyword">int</span> treeLevel[<span class="number">4096</span>], treePath[<span class="number">4096</span>];</div><div class="line"><span class="keyword">void</span> dfs(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> level) {</div><div class="line">	treeLevel[u] = level, treePath[level] = u;	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;i) &lt; level; i++) {</div><div class="line">		dp[u][i] = max(dp[u][i-<span class="number">1</span>], dp[dpw[u][i-<span class="number">1</span>]][i-<span class="number">1</span>]);</div><div class="line">		dpw[u][i] = treePath[level-(<span class="number">1</span>&lt;&lt;i)];</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tree[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = tree[u][i].y;</div><div class="line">		<span class="keyword">if</span>(v == p)	<span class="keyword">continue</span>;		</div><div class="line">		dp[v][<span class="number">0</span>] = tree[u][i].v;</div><div class="line">		dpw[v][<span class="number">0</span>] = u;</div><div class="line">		dfs(v, u, level + <span class="number">1</span>);</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="keyword">int</span> query(<span class="keyword">int</span> x, <span class="keyword">int</span> y) {</div><div class="line">	<span class="keyword">int</span> hx = treeLevel[x], hy = treeLevel[y];</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(x != y &amp;&amp; hx != hy) {</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--) {</div><div class="line">			<span class="keyword">if</span>(<span class="built_in">abs</span>(hx-hy) &gt;= (<span class="number">1</span>&lt;&lt;i)) {</div><div class="line">				<span class="keyword">if</span>(hx &gt; hy) {</div><div class="line">					ret = max(ret, dp[x][i]);</div><div class="line">					x = dpw[x][i];</div><div class="line">					hx -= (<span class="number">1</span>&lt;&lt;i);</div><div class="line">				} <span class="keyword">else</span> {</div><div class="line">					ret = max(ret, dp[y][i]);</div><div class="line">					y = dpw[y][i];</div><div class="line">					hy -= (<span class="number">1</span>&lt;&lt;i); </div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">while</span>(x != y) {</div><div class="line">		ret = max(ret, dp[x][<span class="number">0</span>]);</div><div class="line">		x = dpw[x][<span class="number">0</span>];</div><div class="line">		hx -= (<span class="number">1</span>&lt;&lt;<span class="number">0</span>);</div><div class="line">		ret = max(ret, dp[y][<span class="number">0</span>]);</div><div class="line">		y = dpw[y][<span class="number">0</span>];</div><div class="line">		hy -= (<span class="number">1</span>&lt;&lt;<span class="number">0</span>); </div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></div><div class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout); </span></div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span>(testcase--) {</div><div class="line">        <span class="keyword">int</span> n, m, q, x, y;</div><div class="line"></div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">        	<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;D[i].x, &amp;D[i].y, &amp;D[i].v);        	</div><div class="line">        }</div><div class="line">        </div><div class="line">		<span class="keyword">int</span> mstcost = kruscal(n, m);</div><div class="line">		<span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</div><div class="line">		<span class="built_in">memset</span>(dpw, <span class="number">0</span>, <span class="keyword">sizeof</span>(dpw));</div><div class="line">		dfs(<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>);</div><div class="line">		</div><div class="line"><span class="comment">//		for(int i = 1; i &lt;= n; i++, puts("")) {</span></div><div class="line"><span class="comment">//			printf("[%2d] :", i);</span></div><div class="line"><span class="comment">//			for(int j = 0; (1&lt;&lt;j) &lt;= n; j++)</span></div><div class="line"><span class="comment">//				printf("%d %d, ", dp[i][j], dpw[i][j]);</span></div><div class="line"><span class="comment">//		}</span></div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d\n"</span>, ++cases);</div><div class="line">		<span class="keyword">while</span>(q--) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(x, y));</div><div class="line">		}</div><div class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">	}</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="comment">/*</span></div><div class="line">5</div><div class="line">10 45</div><div class="line">1 2 15</div><div class="line">1 3 11</div><div class="line">1 4 48</div><div class="line">1 5 24</div><div class="line">1 6 45</div><div class="line">1 7 18</div><div class="line">1 8 12</div><div class="line">1 9 40</div><div class="line">1 10 11</div><div class="line">2 3 4</div><div class="line">2 4 9</div><div class="line">2 5 44</div><div class="line">2 6 23</div><div class="line">2 7 39</div><div class="line">2 8 48</div><div class="line">2 9 48</div><div class="line">2 10 22</div><div class="line">3 4 42</div><div class="line">3 5 37</div><div class="line">3 6 10</div><div class="line">3 7 18</div><div class="line">3 8 29</div><div class="line">3 9 8</div><div class="line">3 10 47</div><div class="line">4 5 7</div><div class="line">4 6 17</div><div class="line">4 7 25</div><div class="line">4 8 23</div><div class="line">4 9 32</div><div class="line">4 10 27</div><div class="line">5 6 26</div><div class="line">5 7 21</div><div class="line">5 8 38</div><div class="line">5 9 40</div><div class="line">5 10 39</div><div class="line">6 7 35</div><div class="line">6 8 11</div><div class="line">6 9 39</div><div class="line">6 10 1</div><div class="line">7 8 15</div><div class="line">7 9 10</div><div class="line">7 10 47</div><div class="line">8 9 28</div><div class="line">8 10 11</div><div class="line">9 10 1</div><div class="line">30</div><div class="line">1 6</div><div class="line"></div><div class="line">5</div><div class="line">10 45</div><div class="line">1 2 9</div><div class="line">1 3 12</div><div class="line">1 4 21</div><div class="line">1 5 4</div><div class="line">1 6 32</div><div class="line">1 7 20</div><div class="line">1 8 14</div><div class="line">1 9 28</div><div class="line">1 10 16</div><div class="line">2 3 12</div><div class="line">2 4 23</div><div class="line">2 5 27</div><div class="line">2 6 34</div><div class="line">2 7 43</div><div class="line">2 8 2</div><div class="line">2 9 33</div><div class="line">2 10 35</div><div class="line">3 4 41</div><div class="line">3 5 26</div><div class="line">3 6 16</div><div class="line">3 7 39</div><div class="line">3 8 2</div><div class="line">3 9 49</div><div class="line">3 10 44</div><div class="line">4 5 24</div><div class="line">4 6 2</div><div class="line">4 7 17</div><div class="line">4 8 26</div><div class="line">4 9 20</div><div class="line">4 10 2</div><div class="line">5 6 23</div><div class="line">5 7 5</div><div class="line">5 8 41</div><div class="line">5 9 12</div><div class="line">5 10 15</div><div class="line">6 7 48</div><div class="line">6 8 45</div><div class="line">6 9 13</div><div class="line">6 10 28</div><div class="line">7 8 25</div><div class="line">7 9 12</div><div class="line">7 10 37</div><div class="line">8 9 4</div><div class="line">8 10 5</div><div class="line">9 10 41</div><div class="line">30</div><div class="line">5 4</div><div class="line">1 7</div><div class="line">8 4</div><div class="line">*/</div></pre></td></tr></table></figure>
        
      
    </div>

  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/07/06/oj/uva/uva-12191/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          UVa 12191 - File Recover
        
      </div>
    </a>
  
  
    <a href="/2014/07/06/oj/uva/uva-12045/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">UVa 12045 - Fun with Strings</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
          
            <aside id="sidebar">
  <div id="ukagaka_panel"></div>

  

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">46</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">449</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">409</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2015/04/20/2015-google-code-jam-1A/">
              
                <i class="icon-file-o"></i> 
              
            2015 Google Code Jam Round 1A</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1115/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1115 - Water Shortage</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1089/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1089 - Suffix-Replacement Grammars</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1084/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1084 - Deer-Proof Fence</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1080/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1080 - My Bad</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1078/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1078 - Steam Roller</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1076/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1076 - Password Suspects</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1063/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1063 - Marble Game</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1049/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1049 - Remember the A La Mode</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1048/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1048 - Low Cost Air Travel</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget widget-background1">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮神"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="#" title=""><i class="icon-github-alt"></i> Can you translate world for me ?</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
</aside>

          
            
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://plus.google.com/u/0/108158678174364359204" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2015 Shiang-Yun Yang 
    </div>  

  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/picture" class="mobile-nav-link">Pictures</a>
  
    <a href="/works" class="mobile-nav-link">Works</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  var disqus_url = 'http://morris821028.github.io/2014/07/06/oj/uva/uva-12176/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/jquery.lazyload.js" type="text/javascript"></script>

<script src="/js/jquery.als-1.6.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>