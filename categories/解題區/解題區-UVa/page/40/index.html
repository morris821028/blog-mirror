<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="/img/f.png">
  
  <title>Category: 解題區 - UVa | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ACMer NEET NCU UVa OJ">
<meta property="og:type" content="website">
<meta property="og:title" content="Morris' Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/解題區/解題區-UVa/page/40/">
<meta property="og:site_name" content="Morris' Blog">
<meta property="og:description" content="ACMer NEET NCU UVa OJ">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris' Blog">
<meta name="twitter:description" content="ACMer NEET NCU UVa OJ">
<link rel="publisher" href="108158678174364350000">

  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
  <!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Can you find me ?</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main">
  
    <article id="post-oj/uva/icpc-4020" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/22/oj/uva/icpc-4020/" class="article-date">
  <time datetime="2014-05-22T00:14:25.000Z" itemprop="datePublished">May 22 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/22/oj/uva/icpc-4020/">ICPC 4020 - Hard Rode</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/22/oj/uva/icpc-4020/" data-id="vsk0ekqi6ddac9pm" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/22/oj/uva/icpc-4020/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/窮舉/">窮舉</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>The road to Shu is hard, even harder than climbing to the blue sky. A poem by Li Po from Tang Dynasty 1,200 years ago described the difficulty in travelling into Sichuan.</p>
<p>\epsfbox{p4020.eps}</p>
<p>However the above old saying is no longer true as a convenient communication network of railway, highway, waterway and air transport has come into being. Railways cover a total mileage of 2,693 km, consisting of five trunk lines including the BaojiChengdu and Chengdu-Chongqing railways, eight feeder lines and four local railways. The total mileage of highways stretches to nearly 80,000 km, ranking at the forefront in China. Now a highway network with the provincial capital of Chengdu as the center radiating to all cities in the province has been formed. A total of 500 km of expressways have been built. It is very easy to transfer passengers and freights between Sichuan and other provinces. After a nationwide railway speed acceleration launched in last year, trains can be allowed to run at a speed above 120 km per hour. However, the average speed of a train depends on its make-up. There is only single railway track between stations from Baoji to Chengdu, A primary task for dispatchers is to arrange for trains to meet and pass each other. You are requested to write a program to make the arrangement for a series of trains of different speeds from one station to its next station in the least amount of time.</p>
<p>What you should pay attention to while writing this program is that since there is a single railway track from Baoji to Chengdu, two trains are not allowed to pass the same spot at the same time, or they would be collision, and that because of the limited staff, there should be a fixed interval time between two trains out of the station, what’s more, the trains could pull into the station at the same time, but never get out at the same time.</p>
<h2 id="Input">Input</h2>
<p>The input consists of several test cases. Each test case begins with a line containing 3 integers L (1 &lt;= L &lt;= 100000) , N (1 &lt;= N &lt;= 8) and T (1 &lt; T &lt; 10000) which indicate the distance between two stations (unit is meter), the number of trains, as well as the interval time of adjacent trains when trains leave the start (unit is second).</p>
<p>The next N lines contain average speeds of N trains (unit is m/s).</p>
<p>A single line with L = 0 indicates the end of input file and should not be processed by your program.</p>
<h2 id="Output">Output</h2>
<p>For each test case, your output should be in one line with the minimum time(round to integer) needed by the trains pulling into the terminal as indicated in the sample output.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">100000 6 300 </div><div class="line">3 </div><div class="line">4 </div><div class="line">5 </div><div class="line">6 </div><div class="line">2 </div><div class="line">1 </div><div class="line">0</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Case</span> <span class="number">1</span>: <span class="number">101500</span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述：</strong></p>
<p>從 陝西省寶雞市 到 四川省成都市 有一條鐵軌，而這一條鐵軌一次有好幾台火車在運行，但是不會發生追撞事件，然而每台火車的速度不一樣，而且站務人員會每隔固定時間發一班車，在不發生碰撞的情況下，最後一台火車到達成都市的最少時間為何？</p>
<p><strong> 題目解法：</strong></p>
<p>在這樣的情況，有可能慢車先出發，然在在 <code>T</code> 秒之後，快車恰好追到慢車，這樣的情況會更好。但是實際數據應該長成什麼樣子沒有仔細考慮。</p>
<p>如果使用慢車最後出發，這樣能確保一定不會產生碰撞，但不確定是否是最佳解。</p>
<p>所以使用 <code>O(n!)</code> 的窮舉來計算答案。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> L, N, T, cases = <span class="number">0</span>;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> speed[<span class="number">10</span>];</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;L, &amp;N, &amp;T) == <span class="number">3</span> &amp;&amp; L) {</div><div class="line">		<span class="keyword">int</span> p[<span class="number">10</span>] = {};</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;speed[i]);</div><div class="line">			p[i] = i;</div><div class="line">		}</div><div class="line">		sort(speed, speed + N);</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0x3f3f3f3f</span>;</div><div class="line">		<span class="keyword">do</span> {</div><div class="line">			<span class="keyword">double</span> start = T, lastTime = L / speed[p[<span class="number">0</span>]];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) {</div><div class="line">				<span class="keyword">double</span> time = L / speed[p[i]] + start;</div><div class="line">				<span class="keyword">if</span>(time &gt;= lastTime) {</div><div class="line">					start += T;</div><div class="line">					lastTime = time;</div><div class="line">				} <span class="keyword">else</span> {</div><div class="line">					lastTime = <span class="number">0x3f3f3f3f</span>;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">					<span class="comment">// start += T + (lastTime - time);</span></div><div class="line">				}</div><div class="line">			}</div><div class="line">			ret = min(ret, (<span class="keyword">long</span> <span class="keyword">long</span>) <span class="built_in">ceil</span>(lastTime));</div><div class="line">		} <span class="keyword">while</span> (next_permutation(p, p + N));</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d: %lld\n"</span>, ++cases, ret);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-10320" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/21/oj/uva/uva-10320/" class="article-date">
  <time datetime="2014-05-20T23:33:18.000Z" itemprop="datePublished">May 21 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/21/oj/uva/uva-10320/">UVa 10320 - Cow Trouble! Help Please</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/21/oj/uva/uva-10320/" data-id="dqp3y4ljrpoigpho" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/21/oj/uva/uva-10320/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>There are many classic problem with cows/goats and grass field in the world of mathematics. One of such problems is shown in the picture (left one) below. A goat is tied at point C which is on the edge of a round field with a rope of length R. One has to determine the length R when the cow can eat 50% grass of the round field. But in this problem we will consider a slightly different scenario which is shown in the second figure. In a field of infinite area there is a house ABDC. A cow is tied with pillar B of the house with a rope of length R. The length and width of the house is l and w. If the house was not there the cow could eat all the grass in the round green field (The round green field is a circle of radius R). But the presence of the house will certainly reduce his ability as the cow cannot enter the house nor can any part of the rope. You will have to determine the area the cow can now roam around and eat grass.</p>
<p>Fig 1: A classic Problem with a Goat</p>
<p>Fig 2: The Current Classic Problem with Cow</p>
<h2 id="Input">Input</h2>
<p>The input file contains several lines of input. Each line contains three floating point numbers l, w and R as described in the problem statement. All numbers are less than 10000. Input is terminated by end of file.</p>
<h2 id="Output">Output</h2>
<p>For each line of input produce one line of output. This output denotes the area that the cow can cover by not entering the house. This value should contain ten digits after the decimal point. Output will be checked with special judge. So you should not worry about very small precision errors.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">10 5 5</div><div class="line">10 4 8</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">58.9048622548</div><div class="line">163.3628179867</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述：</strong><br>有一頭牛被一根長度 R 的繩子拴在一棟建築物 ABCD 的 B 點上，草地的範圍為無限大，求牛可以吃到的草的範圍。Input 會給l, w 和 R 表示建築物長寬和繩長；l, w, R &lt; 10000。Output 要輸到小數點第 10 位。</p>
<p><strong> 題目解法：</strong></p>
<p>就是根據 R 的四種情況去討論，其中最麻煩的是對於 <code>R &gt; l + w</code>，這種情況會需要討論重疊的區域，算出三角形夾角然後分別算兩個扇形面積，再弄回重疊區域三角形中的哪一塊有草。</p>
<p>其實這一題的題解網路上是有的，但是 PO 出來是因為自己卡在 WA，原因是這樣子的，假使 <code>A = 0.5 * B</code> 和 <code>A = B / 2</code>，這兩者寫法並無不同，但是後者的精準度比較好，很多次的 WA 都掛在這一點。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">double</span> w, l, r;</div><div class="line">	<span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(-<span class="number">1</span>);</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf"</span>, &amp;l, &amp;w, &amp;r) == <span class="number">3</span>) {</div><div class="line">		<span class="keyword">if</span>(w &gt; l)</div><div class="line">			swap(w, l);</div><div class="line">		<span class="keyword">double</span> area;</div><div class="line">		<span class="keyword">if</span>(r &lt;= w)</div><div class="line">			area = r * r * pi * <span class="number">3</span> / <span class="number">4.0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(r &lt;= l)</div><div class="line">			area = r * r * pi * <span class="number">3</span> / <span class="number">4.0</span> + (r - w) * (r - w) * pi / <span class="number">4.0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(r &lt;= l + w)</div><div class="line">			area = r * r * pi * <span class="number">3</span> / <span class="number">4.0</span> + (r - w) * (r - w) * pi / <span class="number">4.0</span> </div><div class="line">					+ (r - l) * (r - l) * pi / <span class="number">4.0</span>;</div><div class="line">		<span class="keyword">else</span> {</div><div class="line">			<span class="keyword">double</span> a = <span class="built_in">atan2</span>(l, w), b, c;</div><div class="line">			<span class="keyword">double</span> la, lb, lc;</div><div class="line">			</div><div class="line">			la = hypot(w, l);</div><div class="line">			lb = r - w;</div><div class="line">			lc = r - l;</div><div class="line">			b = <span class="built_in">acos</span>((la*la + lb*lb - lc*lc)/(<span class="number">2</span>*la*lb)) + a;</div><div class="line">			c = <span class="built_in">acos</span>((la*la + lc*lc - lb*lb)/(<span class="number">2</span>*la*lc)) + (pi /<span class="number">2</span>) - a;</div><div class="line">						</div><div class="line">			area = r * r * pi * <span class="number">3</span> / <span class="number">4.0</span>;</div><div class="line">			area += (r - w) * (r - w) * (pi - b) / <span class="number">2</span>;</div><div class="line">			area += (r - l) * (r - l) * (pi - c) / <span class="number">2</span>;</div><div class="line">			area += lb * la * <span class="built_in">sin</span>(b - a) / <span class="number">2</span>;</div><div class="line">			area -= w * l / <span class="number">2</span>;</div><div class="line">		}</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%0.10lf\n"</span>, area);			</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12717" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/19/oj/uva/uva-12717/" class="article-date">
  <time datetime="2014-05-19T01:21:04.000Z" itemprop="datePublished">May 19 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/19/oj/uva/uva-12717/">UVa 12717 - Fiasco</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/19/oj/uva/uva-12717/" data-id="rc4yj0ftg8poe8d3" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/19/oj/uva/uva-12717/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/除錯修正/">除錯修正</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Natasha always mixes up things in her algorithm classes. Last week Prof. Chhaya Murthy gave the class a classical problem -finding shortest path to all nodes from a special node of a weighted graph. Before that in another class, the professor taught them Prim’s and Dijkstra’s algorithms which are similar looking but does very different things. Always confused, poor Natasha submitted something<br>very similar to the Prim’s algorithm (actually we should call it Natasha’s  lgorithm), she didn’t test it properly. Pseudocode of her algorithm looks as follows</p>
<p><img class="lazy" data-original="/img/uva12717.png" alt="uva 12717"></p>
<p>After submission, she showed the code to a friend who is good at algorithms. That friend immediately found the aw. Natasha was really terrifed and started to cry. Then there came the guys, the guys who liked her. They jumped at the opportunity and got hold of the dataset to be used to test the solutions. Your friend Rehan is one of those guys. He really wanted to impress Natasha. He asked you to change the dataset in such a way that Natasha’s algorithm gives the right result. After the change, Rehan will somehow be able to put the modified data with the old timestamp. Rehan told you that:</p>
<ol>
<li>The dataset has T test cases.</li>
<li>Each case contains a connected weighted undirected graph with n nodes and<br>m edges.</li>
<li>Each case will contain a source node source.</li>
<li>Edge weights are positive and distinct. </li>
</ol>
<p>To avoid suspicion, Rehan asked you not to change which vertices the edges connect, or the overall set of edge weights. You may only reorder which weights are assigned to which edges</p>
<h2 id="Input">Input</h2>
<p>The first line of the input denotes the number of datasets T (1 &lt; T &lt;= 15). T sets of case will follow. Each case will start with a triplet of numbers n (2 &lt;= n &lt;= 2500), m (1 &lt;= m &lt;= 25000) and source (1 &lt;= source &lt;= n) | the number of nodes, the number of edges and the starting node respectively.</p>
<p>Each of the next m lines will contain a triplet of numbers <code>(u, v, w)</code> meaning that there is an edge between node u and node v with weight w (1 &lt;= w &lt;= m). Nodes are numbered from 1 to n. </p>
<p>It is guaranteed that there is no duplicate or self-edges in the input and the graph is connected. In each given graph, all edge weights will be distinct.</p>
<h2 id="Output">Output</h2>
<p>For each set of input, print one set of output. First line of a set should be of the format, <code>Case X:</code> where X is the case number. Then print each edge triplet | one triplet (u, v, w) in each line separated by a single space. The edges should be printed in the order given in the input. If there is more than one solution to a dataset, any one of them will do.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">7 9 5</div><div class="line">2 4 2</div><div class="line">1 4 8</div><div class="line">7 2 6</div><div class="line">3 4 7</div><div class="line">5 7 5</div><div class="line">7 3 9</div><div class="line">6 1 1</div><div class="line">6 3 4</div><div class="line">5 6 3</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Case</span> <span class="number">1</span>:</div><div class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">7</span></div><div class="line"><span class="number">1</span> <span class="number">4</span> <span class="number">9</span></div><div class="line"><span class="number">7</span> <span class="number">2</span> <span class="number">3</span></div><div class="line"><span class="number">3</span> <span class="number">4</span> <span class="number">8</span></div><div class="line"><span class="number">5</span> <span class="number">7</span> <span class="number">1</span></div><div class="line"><span class="number">7</span> <span class="number">3</span> <span class="number">4</span></div><div class="line"><span class="number">6</span> <span class="number">1</span> <span class="number">5</span></div><div class="line"><span class="number">6</span> <span class="number">3</span> <span class="number">6</span></div><div class="line"><span class="number">5</span> <span class="number">6</span> <span class="number">2</span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述：</strong><br>// 給一個錯誤代碼，修改測資，使錯誤代碼輸出正確。<br>在一門演算法課程中，上到了最短路徑算法，教授指出了 Prim 和 Dijkstra 算法之間的不同，課堂上有個妹子很不小心搞混了這兩個算法，甚至弄出了更奇怪的程序，這代碼其中有缺陷，她和朋友分享代碼後，沒想到朋友瞬間戳出輸出錯誤的測資，妹子一時之間哭了出來。</p>
<p>現在為了擄獲芳心，請修改測資，使得錯誤代碼有一樣的正確輸出。</p>
<p><strong> 題目解法：</strong><br>這個妹子錯的地方在於，更新的時候，沒有將為探訪點的情況加以考慮，直接以 BFS 的方式丟入，那麼在隨後更新的路徑長就不會被丟入 Priority Queue，這樣在 Dijkstra 的更新順序上就會出錯。也就是說，只要 Graph 的權重依據 BFS 順序 符合由小到大，不會出現隨後更新的問題即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;queue&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;</span> g[<span class="number">2505</span>];</div><div class="line"><span class="keyword">int</span> used[<span class="number">25005</span>];</div><div class="line"><span class="keyword">int</span> in_x[<span class="number">25005</span>], in_y[<span class="number">25005</span>], in_w[<span class="number">25005</span>];</div><div class="line"><span class="stl_container"><span class="built_in">map</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span>, <span class="keyword">int</span>&gt; shortest_tree;</div><div class="line"></div><div class="line"><span class="keyword">void</span> bfs(<span class="keyword">int</span> source) {</div><div class="line">	<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;</span> 	Q;</div><div class="line">	<span class="keyword">int</span> 		u, v, e = <span class="number">0</span>;</div><div class="line">	Q.push(source), used[source] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(!Q.empty()) {</div><div class="line">		u = Q.front(), Q.pop();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) {</div><div class="line">			v = g[u][i];</div><div class="line">			<span class="keyword">if</span>(used[v])	<span class="keyword">continue</span>;</div><div class="line">			used[v] = <span class="number">1</span>;</div><div class="line">			shortest_tree[make_pair(u, v)] = in_w[e], e++;</div><div class="line">			Q.push(v);</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> n, m, source;</div><div class="line">	<span class="keyword">int</span> x, y, w;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">	<span class="keyword">while</span>(testcase--) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;n, &amp;m, &amp;source);</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">			g[i].clear();</div><div class="line">			used[i] = <span class="number">0</span>;</div><div class="line">		}</div><div class="line">		shortest_tree.clear();</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;x, &amp;y, &amp;w);</div><div class="line">			g[x].push_back(y);</div><div class="line">			g[y].push_back(x);</div><div class="line">			in_x[i] = x, in_y[i] = y, in_w[i] = w;</div><div class="line">		}</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			sort(g[i].begin(), g[i].end());</div><div class="line">		sort(in_w, in_w + m);</div><div class="line">		bfs(source);</div><div class="line">		</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>, ++cases);</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span>, <span class="keyword">int</span>&gt;::iterator it, jt, kt;</div><div class="line">		<span class="keyword">int</span> e = m - <span class="number">1</span>;</div><div class="line">		kt = shortest_tree.end();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">			it = shortest_tree.find(make_pair(in_x[i], in_y[i]));</div><div class="line">			jt = shortest_tree.find(make_pair(in_y[i], in_x[i]));</div><div class="line">			<span class="keyword">if</span>(it != kt)</div><div class="line">				w = it-&gt;second;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(jt != kt)</div><div class="line">				w = jt-&gt;second;</div><div class="line">			<span class="keyword">else</span></div><div class="line">				w = in_w[e], e--;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, in_x[i], in_y[i], w);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="comment">/*</span></div><div class="line">1</div><div class="line">7 9 5</div><div class="line">2 4 2</div><div class="line">1 4 8</div><div class="line">7 2 6</div><div class="line">3 4 7</div><div class="line">5 7 5</div><div class="line">7 3 9</div><div class="line">6 1 1</div><div class="line">6 3 4</div><div class="line">5 6 3</div><div class="line">*/</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12716" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/19/oj/uva/uva-12716/" class="article-date">
  <time datetime="2014-05-19T00:58:46.000Z" itemprop="datePublished">May 19 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/19/oj/uva/uva-12716/">UVa 12716 - GCD XOR</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/19/oj/uva/uva-12716/" data-id="uy5n8vfpqyfzlzi3" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/19/oj/uva/uva-12716/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/觀察/">觀察</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Given an integer N, Find how many pairs (A, B) are there such that <code>gcd(A, B) = A xor B</code> where 1 &lt; B &lt; A &lt;= N. Here gcd(A, B) means the greatest common divisor of the numbers A and B. And A xor B is the value of the bitwise xor operation on the binary representation of A and B.</p>
<h2 id="Input">Input</h2>
<p>The First line of the input contains an integer T (T &lt; 10000) denoting the number of test cases. The following T lines contain an integer N (1 &lt;= N &lt;= 30000000).</p>
<h2 id="Output">Output</h2>
<p>For each test case, print the case number first in the format, <code>Case X:</code> (here, X is the serial of the input) followed by a space and then the answer for that case.<br>There is no new-line between cases.</p>
<p>Explanation<br>Sample 1:<br>For N = 7, there are four valid pairs: (3, 2), (5, 4), (6, 4) and (7, 6).</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">7</div><div class="line">20000000</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Case</span> <span class="number">1</span>: <span class="number">4</span></div><div class="line"><span class="keyword">Case</span> <span class="number">2</span>: <span class="number">34866117</span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p>首先，嘗試把 <code>N &lt;= 1000</code> 的情況列下來，列出 <code>gcd(A, B) = C = A xor B</code></p>
<p>其中滿足 <code>B &lt; A and A mod C = 0</code>，然後我們又觀察到 <code>A&amp;C == C</code>，也就是說看 bitmask 的話，C 是 A 的 subset。</p>
<p>經由這一點，我們可以先寫出一個不會過 (TLE) 的做法，對 A 找到所有因子 C，查看是否符合 <code>A&amp;C == C</code>，但是這樣的做法很容易知道時間效率不夠好。</p>
<p>下面是一個最簡單的版本。</p>
<figure class="highlight cpp"><figcaption><span>TLE version</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> maxL (30000000&gt;&gt;5)+1</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> GET(x) (mark[(x)&gt;&gt;5]&gt;&gt;((x)&amp;31)&amp;1)</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> SET(x) (mark[(x)&gt;&gt;5] |= 1&lt;&lt;((x)&amp;31))</span></div><div class="line"><span class="keyword">int</span> mark[maxL];</div><div class="line"><span class="keyword">int</span> P[<span class="number">5500</span>], Pt = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> F[<span class="number">30000005</span>] = {};</div><div class="line"><span class="keyword">void</span> sieve() {</div><div class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, j, k, l;</div><div class="line">    SET(<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> n = <span class="number">50000</span>;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">2</span>; i &lt;= n; i++) {</div><div class="line">        <span class="keyword">if</span>(!GET(i)) {</div><div class="line">            <span class="keyword">for</span>(j = i + i; j &lt;= n; j += i)</div><div class="line">                SET(j);</div><div class="line">            P[Pt++] = i;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span> &gt; factor(<span class="keyword">int</span> n) {</div><div class="line">	<span class="keyword">int</span> on = n;</div><div class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span> &gt; R;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j; i &lt; Pt &amp;&amp; P[i] * P[i] &lt;= n; i++) {</div><div class="line">		<span class="keyword">if</span>(n%P[i] == <span class="number">0</span>) {		</div><div class="line">			<span class="keyword">for</span>(j = <span class="number">0</span>; n%P[i] == <span class="number">0</span>; n /= P[i], j++);</div><div class="line">			R.push_back(make_pair(P[i], j));</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span>(n != <span class="number">1</span>)	R.push_back(make_pair(n, <span class="number">1</span>));</div><div class="line">	<span class="keyword">return</span> R;</div><div class="line">}</div><div class="line"><span class="keyword">void</span> make(<span class="keyword">int</span> idx, <span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span> &gt; &amp;v) {</div><div class="line">	<span class="keyword">if</span>(idx == v.size()) {</div><div class="line">		<span class="keyword">if</span>((n&amp;m) == m)</div><div class="line">			F[n]++;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> a = m, b = v[idx].first;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = v[idx].second; i &gt;= <span class="number">0</span>; i--)</div><div class="line">		make(idx + <span class="number">1</span>, n, a, v), a *= b;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	sieve();</div><div class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span> &gt; ff;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">30000000</span>; i++) {</div><div class="line">		ff = factor(i);</div><div class="line">		make(<span class="number">0</span>, i, <span class="number">1</span>, ff);</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> testcase, cases = <span class="number">0</span>, n;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">	<span class="keyword">while</span>(testcase--) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">		<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			ret += F[i];</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret - n);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>接著，使用其他的考慮方式，既然 <code>(n, n + 1)</code> 是已知解，其倍數解 <code>(kn, k(n + 1))</code>也是考量的一部分。</p>
<p>總歸一句，觀察 orz。</p>
<figure class="highlight cpp"><figcaption><span>accepted</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> F[<span class="number">30000005</span>] = {};</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">30000000</span>; i++) {</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = i &lt;&lt; <span class="number">1</span>; i + j &lt;= <span class="number">30000000</span>; j += i) {</div><div class="line">			<span class="keyword">if</span>(((i + j)&amp;(j)) == j)</div><div class="line">				F[i + j]++;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">30000000</span>; i++)</div><div class="line">		F[i] += F[i-<span class="number">1</span>];</div><div class="line">	<span class="keyword">int</span> testcase, cases = <span class="number">0</span>, n;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">	<span class="keyword">while</span>(testcase--) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d: %d\n"</span>, ++cases, F[n]);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11291-with-yacc" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/12/oj/uva/uva-11291-with-yacc/" class="article-date">
  <time datetime="2014-05-12T10:54:49.000Z" itemprop="datePublished">May 12 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/12/oj/uva/uva-11291-with-yacc/">Yacc 與 Lex 練習 - UVa 11291</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/12/oj/uva/uva-11291-with-yacc/" data-id="95gbwt57c90avbbq" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/12/oj/uva/uva-11291-with-yacc/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Lex/">Lex</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Yacc/">Yacc</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h1 id="Problem">Problem</h1>
<p>詳細題目請參考 <a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=24&amp;page=show_problem&amp;problem=2266" target="_blank" rel="external">UVa 11291 - Smeech</a></p>
<p>語法</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&lt;E[x]&gt;</span> -&gt; &lt;<span class="constant">Integer</span>&gt; | (p &lt;<span class="constant">E</span>[x]&gt; &lt;<span class="constant">E</span>[x]&gt;)</span></div><div class="line"><span class="input"><span class="prompt">&lt;Integer&gt;</span> -&gt; <span class="comment">#number</span></span></div></pre></td></tr></table></figure>

<p>目標計算出 <code>E[X] = p * (e1 + e2) + (1 - p) * (e1 - e2)</code></p>
<h1 id="Yacc">Yacc</h1>
<p>Yacc 主要是根據 CFG 進行解析。</p>
<p>其中，要對於 Yacc 語法的回傳值明白操作情況。</p>
<p>對於語法回傳值，我們來個最簡單的範例：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">expression -&gt;</span> <span class="constant">LEFT_P</span> <span class="constant">NUMBER</span> expression expression <span class="constant">RIGHT_P</span></span></div><div class="line">    <span class="variable">$$</span>          <span class="variable">$1</span>     <span class="variable">$2</span>       <span class="variable">$3</span>         <span class="variable">$4</span>       <span class="variable">$5</span></div></pre></td></tr></table></figure>

<p>其中 <code>$$</code> 是回傳值，其中的 <code>$1</code>、<code>$2</code> … 等，都是得到的回傳值。</p>
<p>對於 <code>yylval</code> 形態處理：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">%<span class="keyword">union</span> {</div><div class="line">	<span class="built_in">float</span> 	floatVal;</div><div class="line">	<span class="keyword">int</span> 	intVal;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>通常使用 <code>union</code> 的方式來共用記憶體，在 lex 那邊就可以根據 <code>yylval.floatVal</code> 進行操作。</p>
<p>當然，我們也要對於每一個 <code>nonterminal</code> 定義回傳的型態</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">%type &lt;floatVal&gt;</span> <span class="constant">NUMBER</span></span></div><div class="line"><span class="input"><span class="prompt">%type &lt;floatVal&gt;</span> expression</span></div><div class="line"><span class="input"><span class="prompt">%type &lt;floatVal&gt;</span> startsymbol</span></div></pre></td></tr></table></figure>

<p>基本上就大功告成了。</p>
<p>接著要考慮如何去完成多組測資組的問題，在這裡可以利用 kleene star 來完成。</p>
<p>但是對於輸出順序，使用 <code>input -&gt; input startsymbol</code> 跟 <code>input -&gt; startsymbol input</code> 輸出順序是不同的，如果要順著輸出，請選擇前者。</p>
<figure class="highlight cpp"><figcaption><span>file: a.y</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">%{</div><div class="line"></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="keyword">int</span> yylex();</div><div class="line"><span class="keyword">double</span> ans = <span class="number">0</span>;</div><div class="line"><span class="keyword">void</span> yyerror(<span class="keyword">const</span> <span class="keyword">char</span>* message) {</div><div class="line">	ans = -<span class="number">2147483647</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"Invaild format\n"</span>);</div><div class="line">};</div><div class="line">%}</div><div class="line"></div><div class="line">%<span class="keyword">union</span> {</div><div class="line">	<span class="keyword">float</span> 	floatVal;</div><div class="line">	<span class="keyword">int</span> 	intVal;</div><div class="line">}</div><div class="line">%type &lt;floatVal&gt; NUMBER</div><div class="line">%type &lt;floatVal&gt; expression</div><div class="line">%type &lt;floatVal&gt; startsymbol</div><div class="line"></div><div class="line">%token LEFT_P RIGHT_P NUMBER</div><div class="line"></div><div class="line">%%</div><div class="line">input</div><div class="line">	: input startsymbol {</div><div class="line">		ans = $<span class="number">2</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%.2f\n"</span>, ans);</div><div class="line">	}</div><div class="line">	| {</div><div class="line">	}</div><div class="line">startsymbol</div><div class="line">	: expression {</div><div class="line">		$$ = $<span class="number">1</span>;</div><div class="line">	}</div><div class="line">	;</div><div class="line">expression</div><div class="line">	: NUMBER {</div><div class="line">		$$ = $<span class="number">1</span>;</div><div class="line">	} </div><div class="line">	| LEFT_P NUMBER expression expression RIGHT_P {</div><div class="line">		$$ = $<span class="number">2</span> * ($<span class="number">3</span> + $<span class="number">4</span>) + (<span class="number">1.0f</span> - $<span class="number">2</span>) * ($<span class="number">3</span> - $<span class="number">4</span>);</div><div class="line">	}</div><div class="line">	;</div><div class="line">%%</div><div class="line"></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	yyparse();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<h1 id="Lex">Lex</h1>
<p>Lex 主要是扮演切出所有的 token 的角色，相當於 Scanner。同時要將值紀錄再 <code>yylval</code> 中，在 Yacc 那邊則會在 <code>$NUMBER</code> 中得到變數值。</p>
<p>在 Lex 語法上要特別小心，如果兩條的前綴 (prefix) 相同時 (解析上會產生相同的 token)，則會選擇長的那一條為優先。如果長度仍相同的話，請自行測試，這裡無法給予解答。而為什麼要這麼設計？為了保證後綴不會塞入奇怪的字符，因此可以先檢查隨後接的字符情況。</p>
<figure class="highlight cpp"><figcaption><span>file: a.l</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">%{</div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> "a.tab.h"</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line">%}</div><div class="line"></div><div class="line">%%</div><div class="line">([-]?)[<span class="number">0</span>-<span class="number">9</span>]*\.[<span class="number">0</span>-<span class="number">9</span>]*		{<span class="built_in">sscanf</span>(yytext, <span class="string">"%f"</span>, &amp;yylval.floatVal); <span class="keyword">return</span> NUMBER;}</div><div class="line">([-]?)[<span class="number">0</span>-<span class="number">9</span>]+				{<span class="built_in">sscanf</span>(yytext, <span class="string">"%f"</span>, &amp;yylval.floatVal); <span class="keyword">return</span> NUMBER;}</div><div class="line"><span class="string">"("</span>					{<span class="keyword">return</span> LEFT_P;}</div><div class="line"><span class="string">")"</span>					{<span class="keyword">return</span> RIGHT_P;}</div><div class="line">\n					{}</div><div class="line">.					{}</div><div class="line">%%</div></pre></td></tr></table></figure>

<h1 id="make_file">make file</h1>
<p>請用以下方法建造</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">morris $ <span class="keyword">sh</span> <span class="keyword">make</span>.<span class="keyword">sh</span></div></pre></td></tr></table></figure>

<p>代碼如下</p>
<figure class="highlight"><figcaption><span>file: make.sh</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">bison -d <span class="operator">a</span>.y</div><div class="line">flex <span class="operator">a</span>.l</div><div class="line">gcc -c <span class="operator">a</span>.<span class="constant">tab</span>.c</div><div class="line">gcc -c lex.yy.c</div><div class="line">gcc lex.yy.o <span class="operator">a</span>.<span class="constant">tab</span>.o -lfl</div></pre></td></tr></table></figure>

<p>產生的結果如下</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$ tree </div><div class="line">. ├── <span class="keyword">a</span>.<span class="keyword">l</span></div><div class="line">  ├── <span class="keyword">a</span>.out </div><div class="line">  ├── <span class="keyword">a</span>.<span class="keyword">tab</span>.<span class="keyword">c</span> </div><div class="line">  ├── <span class="keyword">a</span>.<span class="keyword">tab</span>.<span class="keyword">h</span> </div><div class="line">  ├── <span class="keyword">a</span>.<span class="keyword">tab</span>.<span class="keyword">o</span> </div><div class="line">  ├── <span class="keyword">a</span>.<span class="keyword">y</span> </div><div class="line">  ├── <span class="built_in">input</span>~ </div><div class="line">  ├── <span class="keyword">lex</span>.yy.<span class="keyword">c</span> </div><div class="line">  ├── <span class="keyword">lex</span>.yy.<span class="keyword">o</span> </div><div class="line">  ├── <span class="keyword">make</span>.<span class="keyword">sh</span> </div><div class="line">  ├── <span class="keyword">make</span>.<span class="keyword">sh</span>~ </div><div class="line">  ├── testdata </div><div class="line">  │   ├── ac_output </div><div class="line">  │   └── <span class="built_in">input</span></div></pre></td></tr></table></figure>

<h1 id="執行">執行</h1>
<p>執行的時候就跟標準輸入串流一樣。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">morris $ ./a.<span class="keyword">out</span> &lt;input</div></pre></td></tr></table></figure>

<h2 id="參考範例輸入">參考範例輸入</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="number">7</span></div><div class="line"><span class="list">(.<span class="number">5</span> <span class="number">3</span> <span class="number">9</span>)</span></div><div class="line"><span class="list">(<span class="number">0.3</span> <span class="number">2</span> <span class="list">(<span class="number">1</span> <span class="number">1</span> <span class="number">-10</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">1.0</span> <span class="list">(<span class="number">1.0</span> <span class="list">(<span class="number">1.0</span> <span class="number">-1</span> <span class="number">-2</span>)</span> <span class="list">(<span class="number">1.0</span> <span class="number">-1</span> <span class="number">-2</span>)</span>)</span> <span class="list">(<span class="number">1.0</span> <span class="list">(<span class="number">1.0</span> <span class="number">1</span> <span class="number">2</span>)</span> <span class="number">2</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.99</span> <span class="number">82</span> <span class="list">(<span class="number">0.76</span> <span class="number">50</span> <span class="list">(<span class="number">0.85</span> <span class="list">(<span class="number">0.07</span> <span class="list">(<span class="number">0.88</span> <span class="number">28</span> <span class="list">(<span class="number">0.98</span> <span class="number">79</span> <span class="list">(<span class="number">0.09</span> <span class="number">77</span> <span class="number">51</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.30</span> <span class="list">(<span class="number">0.29</span> <span class="number">36</span> <span class="list">(<span class="number">0.36</span> <span class="list">(<span class="number">0.51</span> <span class="number">27</span> <span class="list">(<span class="number">0.68</span> <span class="list">(<span class="number">0.47</span> <span class="number">87</span> <span class="number">35</span>)</span> <span class="list">(<span class="number">0.25</span> <span class="number">85</span> <span class="number">59</span>)</span>)</span>)</span> <span class="number">31</span>)</span>)</span> <span class="number">64</span>)</span>)</span> <span class="list">(<span class="number">0.14</span> <span class="list">(<span class="number">0.84</span> <span class="list">(<span class="number">0.77</span> <span class="number">29</span> <span class="number">71</span>)</span> <span class="list">(<span class="number">0.50</span> <span class="list">(<span class="number">0.99</span> <span class="list">(<span class="number">0.81</span> <span class="list">(<span class="number">0.78</span> <span class="list">(<span class="number">0.87</span> <span class="number">50</span> <span class="number">7</span>)</span> <span class="number">71</span>)</span> <span class="number">72</span>)</span> <span class="number">14</span>)</span> <span class="list">(<span class="number">0.30</span> <span class="list">(<span class="number">0.50</span> <span class="number">9</span> <span class="number">37</span>)</span> <span class="list">(<span class="number">0.67</span> <span class="number">21</span> <span class="list">(<span class="number">0.73</span> <span class="number">86</span> <span class="list">(<span class="number">0.08</span> <span class="number">31</span> <span class="number">14</span>)</span>)</span>)</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.94</span> <span class="list">(<span class="number">0.96</span> <span class="list">(<span class="number">0.50</span> <span class="number">27</span> <span class="list">(<span class="number">0.94</span> <span class="list">(<span class="number">0.54</span> <span class="number">62</span> <span class="list">(<span class="number">0.63</span> <span class="number">89</span> <span class="number">29</span>)</span>)</span> <span class="list">(<span class="number">0.81</span> <span class="number">24</span> <span class="list">(<span class="number">0.94</span> <span class="number">20</span> <span class="number">72</span>)</span>)</span>)</span>)</span> <span class="number">4</span>)</span> <span class="list">(<span class="number">0.44</span> <span class="number">9</span> <span class="list">(<span class="number">0.59</span> <span class="list">(<span class="number">0.70</span> <span class="number">48</span> <span class="number">40</span>)</span> <span class="list">(<span class="number">0.64</span> <span class="list">(<span class="number">0.27</span> <span class="number">97</span> <span class="number">71</span>)</span> <span class="number">43</span>)</span>)</span>)</span>)</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.15</span> <span class="number">12</span> <span class="number">60</span>)</span></div><div class="line"><span class="list">(<span class="number">0.55</span> <span class="number">18</span> <span class="list">(<span class="number">0.95</span> <span class="list">(<span class="number">0.79</span> <span class="number">95</span> <span class="list">(<span class="number">0.97</span> <span class="list">(<span class="number">0.11</span> <span class="list">(<span class="number">0.96</span> <span class="list">(<span class="number">0.70</span> <span class="list">(<span class="number">0.38</span> <span class="number">73</span> <span class="number">66</span>)</span> <span class="list">(<span class="number">0.38</span> <span class="list">(<span class="number">0.06</span> <span class="list">(<span class="number">0.02</span> <span class="number">88</span> <span class="number">66</span>)</span> <span class="list">(<span class="number">0.39</span> <span class="number">35</span> <span class="number">37</span>)</span>)</span> <span class="number">69</span>)</span>)</span> <span class="list">(<span class="number">0.81</span> <span class="number">3</span> <span class="list">(<span class="number">0.45</span> <span class="number">5</span> <span class="number">61</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.44</span> <span class="list">(<span class="number">0.67</span> <span class="list">(<span class="number">0.23</span> <span class="number">82</span> <span class="number">7</span>)</span> <span class="number">38</span>)</span> <span class="list">(<span class="number">0.24</span> <span class="number">49</span> <span class="number">74</span>)</span>)</span>)</span> <span class="number">76</span>)</span>)</span> <span class="list">(<span class="number">0.46</span> <span class="number">19</span> <span class="number">44</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.56</span> <span class="number">62</span> <span class="number">77</span>)</span></div><div class="line"><span class="list">(<span class="number">0.03</span> <span class="list">(<span class="number">0.90</span> <span class="number">19</span> <span class="number">35</span>)</span> <span class="list">(<span class="number">0.17</span> <span class="number">50</span> <span class="list">(<span class="number">0.13</span> <span class="list">(<span class="number">0.96</span> <span class="number">74</span> <span class="list">(<span class="number">0.07</span> <span class="list">(<span class="number">0.51</span> <span class="number">78</span> <span class="list">(<span class="number">0.77</span> <span class="list">(<span class="number">0.78</span> <span class="list">(<span class="number">0.84</span> <span class="number">64</span> <span class="list">(<span class="number">0.41</span> <span class="number">7</span> <span class="number">59</span>)</span>)</span> <span class="number">21</span>)</span> <span class="list">(<span class="number">0.73</span> <span class="list">(<span class="number">0.95</span> <span class="list">(<span class="number">0.13</span> <span class="number">2</span> <span class="number">85</span>)</span> <span class="list">(<span class="number">0.08</span> <span class="number">29</span> <span class="number">50</span>)</span>)</span> <span class="list">(<span class="number">0.24</span> <span class="list">(<span class="number">0.12</span> <span class="number">43</span> <span class="number">99</span>)</span> <span class="number">71</span>)</span>)</span>)</span>)</span> <span class="number">84</span>)</span>)</span> <span class="list">(<span class="number">0.31</span> <span class="number">69</span> <span class="list">(<span class="number">0.82</span> <span class="number">31</span> <span class="number">24</span>)</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.78</span> <span class="number">73</span> <span class="number">44</span>)</span></div><div class="line"><span class="list">(<span class="number">0.09</span> <span class="list">(<span class="number">0.80</span> <span class="number">14</span> <span class="number">62</span>)</span> <span class="list">(<span class="number">0.57</span> <span class="list">(<span class="number">0.57</span> <span class="number">95</span> <span class="list">(<span class="number">0.33</span> <span class="number">94</span> <span class="number">31</span>)</span>)</span> <span class="list">(<span class="number">0.70</span> <span class="list">(<span class="number">0.92</span> <span class="number">32</span> <span class="list">(<span class="number">0.13</span> <span class="number">20</span> <span class="list">(<span class="number">0.44</span> <span class="number">87</span> <span class="list">(<span class="number">0.45</span> <span class="number">83</span> <span class="number">26</span>)</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.43</span> <span class="number">40</span> <span class="list">(<span class="number">0.51</span> <span class="list">(<span class="number">0.57</span> <span class="number">29</span> <span class="list">(<span class="number">0.65</span> <span class="number">13</span> <span class="list">(<span class="number">0.40</span> <span class="number">74</span> <span class="number">56</span>)</span>)</span>)</span> <span class="number">56</span>)</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.96</span> <span class="list">(<span class="number">0.96</span> <span class="list">(<span class="number">0.65</span> <span class="list">(<span class="number">0.01</span> <span class="list">(<span class="number">0.98</span> <span class="list">(<span class="number">0.34</span> <span class="number">86</span> <span class="list">(<span class="number">0.68</span> <span class="number">87</span> <span class="number">21</span>)</span>)</span> <span class="number">27</span>)</span> <span class="list">(<span class="number">0.26</span> <span class="number">68</span> <span class="number">68</span>)</span>)</span> <span class="list">(<span class="number">0.42</span> <span class="number">28</span> <span class="number">29</span>)</span>)</span> <span class="number">9</span>)</span> <span class="number">99</span>)</span></div><div class="line"><span class="list">(<span class="number">0.99</span> <span class="list">(<span class="number">0.60</span> <span class="number">53</span> <span class="number">27</span>)</span> <span class="list">(<span class="number">0.35</span> <span class="number">23</span> <span class="list">(<span class="number">0.15</span> <span class="list">(<span class="number">0.50</span> <span class="number">85</span> <span class="list">(<span class="number">0.73</span> <span class="number">56</span> <span class="list">(<span class="number">0.34</span> <span class="list">(<span class="number">0.44</span> <span class="list">(<span class="number">0.10</span> <span class="list">(<span class="number">0.62</span> <span class="list">(<span class="number">0.20</span> <span class="number">58</span> <span class="number">15</span>)</span> <span class="number">56</span>)</span> <span class="list">(<span class="number">0.57</span> <span class="number">74</span> <span class="list">(<span class="number">0.23</span> <span class="number">20</span> <span class="number">78</span>)</span>)</span>)</span> <span class="number">62</span>)</span> <span class="list">(<span class="number">0.92</span> <span class="list">(<span class="number">0.72</span> <span class="list">(<span class="number">0.82</span> <span class="number">75</span> <span class="list">(<span class="number">0.08</span> <span class="number">35</span> <span class="number">93</span>)</span>)</span> <span class="number">43</span>)</span> <span class="list">(<span class="number">0.55</span> <span class="number">10</span> <span class="list">(<span class="number">0.45</span> <span class="list">(<span class="number">0.25</span> <span class="number">52</span> <span class="number">91</span>)</span> <span class="number">71</span>)</span>)</span>)</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.61</span> <span class="number">39</span> <span class="list">(<span class="number">0.49</span> <span class="list">(<span class="number">0.92</span> <span class="number">87</span> <span class="list">(<span class="number">0.13</span> <span class="number">52</span> <span class="list">(<span class="number">0.69</span> <span class="list">(<span class="number">0.46</span> <span class="list">(<span class="number">0.82</span> <span class="number">27</span> <span class="number">72</span>)</span> <span class="number">96</span>)</span> <span class="list">(<span class="number">0.27</span> <span class="number">51</span> <span class="number">99</span>)</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.36</span> <span class="number">99</span> <span class="list">(<span class="number">0.60</span> <span class="number">68</span> <span class="list">(<span class="number">0.49</span> <span class="list">(<span class="number">0.25</span> <span class="list">(<span class="number">0.92</span> <span class="number">54</span> <span class="number">7</span>)</span> <span class="list">(<span class="number">0.48</span> <span class="number">47</span> <span class="number">32</span>)</span>)</span> <span class="list">(<span class="number">0.08</span> <span class="list">(<span class="number">0.69</span> <span class="number">97</span> <span class="number">11</span>)</span> <span class="number">34</span>)</span>)</span>)</span>)</span>)</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.87</span> <span class="list">(<span class="number">0.32</span> <span class="list">(<span class="number">0.42</span> <span class="list">(<span class="number">0.66</span> <span class="number">69</span> <span class="list">(<span class="number">0.98</span> <span class="number">0</span> <span class="list">(<span class="number">0.46</span> <span class="number">94</span> <span class="list">(<span class="number">0.25</span> <span class="list">(<span class="number">0.57</span> <span class="list">(<span class="number">0.72</span> <span class="number">25</span> <span class="number">59</span>)</span> <span class="list">(<span class="number">0.35</span> <span class="number">91</span> <span class="list">(<span class="number">0.42</span> <span class="number">29</span> <span class="number">28</span>)</span>)</span>)</span> <span class="number">3</span>)</span>)</span>)</span>)</span> <span class="number">19</span>)</span> <span class="number">81</span>)</span> <span class="list">(<span class="number">0.72</span> <span class="list">(<span class="number">0.06</span> <span class="list">(<span class="number">0.66</span> <span class="list">(<span class="number">0.07</span> <span class="number">22</span> <span class="number">87</span>)</span> <span class="number">44</span>)</span> <span class="list">(<span class="number">0.18</span> <span class="number">33</span> <span class="number">14</span>)</span>)</span> <span class="number">49</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.72</span> <span class="list">(<span class="number">0.01</span> <span class="number">67</span> <span class="list">(<span class="number">0.13</span> <span class="list">(<span class="number">0.22</span> <span class="list">(<span class="number">0.88</span> <span class="number">11</span> <span class="number">86</span>)</span> <span class="list">(<span class="number">0.04</span> <span class="number">40</span> <span class="list">(<span class="number">0.41</span> <span class="list">(<span class="number">0.86</span> <span class="list">(<span class="number">0.81</span> <span class="list">(<span class="number">0.08</span> <span class="number">84</span> <span class="number">95</span>)</span> <span class="list">(<span class="number">0.88</span> <span class="number">19</span> <span class="number">67</span>)</span>)</span> <span class="number">8</span>)</span> <span class="number">96</span>)</span>)</span>)</span> <span class="number">13</span>)</span>)</span> <span class="list">(<span class="number">0.13</span> <span class="number">45</span> <span class="list">(<span class="number">0.19</span> <span class="list">(<span class="number">0.83</span> <span class="number">85</span> <span class="list">(<span class="number">0.77</span> <span class="list">(<span class="number">0.37</span> <span class="number">78</span> <span class="list">(<span class="number">0.44</span> <span class="number">44</span> <span class="number">59</span>)</span>)</span> <span class="number">37</span>)</span>)</span> <span class="number">56</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.51</span> <span class="list">(<span class="number">0.36</span> <span class="number">2</span> <span class="number">72</span>)</span> <span class="number">25</span>)</span></div><div class="line"><span class="list">(<span class="number">0.32</span> <span class="number">51</span> <span class="number">87</span>)</span></div><div class="line"><span class="list">(<span class="number">0.06</span> <span class="list">(<span class="number">0.23</span> <span class="list">(<span class="number">0.70</span> <span class="number">93</span> <span class="number">47</span>)</span> <span class="list">(<span class="number">0.22</span> <span class="number">20</span> <span class="list">(<span class="number">0.90</span> <span class="list">(<span class="number">0.03</span> <span class="list">(<span class="number">0.48</span> <span class="list">(<span class="number">0.84</span> <span class="number">18</span> <span class="list">(<span class="number">0.29</span> <span class="list">(<span class="number">0.02</span> <span class="list">(<span class="number">0.06</span> <span class="number">52</span> <span class="number">49</span>)</span> <span class="number">67</span>)</span> <span class="list">(<span class="number">0.49</span> <span class="list">(<span class="number">0.69</span> <span class="number">60</span> <span class="number">74</span>)</span> <span class="list">(<span class="number">0.59</span> <span class="number">92</span> <span class="number">0</span>)</span>)</span>)</span>)</span> <span class="number">32</span>)</span> <span class="number">80</span>)</span> <span class="list">(<span class="number">0.76</span> <span class="number">78</span> <span class="list">(<span class="number">0.66</span> <span class="number">8</span> <span class="number">94</span>)</span>)</span>)</span>)</span>)</span> <span class="number">31</span>)</span></div><div class="line"><span class="list">(<span class="number">0.29</span> <span class="list">(<span class="number">0.54</span> <span class="number">70</span> <span class="list">(<span class="number">0.64</span> <span class="list">(<span class="number">0.48</span> <span class="list">(<span class="number">0.50</span> <span class="number">25</span> <span class="list">(<span class="number">0.38</span> <span class="list">(<span class="number">0.07</span> <span class="list">(<span class="number">0.14</span> <span class="list">(<span class="number">0.44</span> <span class="list">(<span class="number">0.76</span> <span class="number">44</span> <span class="number">45</span>)</span> <span class="number">67</span>)</span> <span class="number">41</span>)</span> <span class="list">(<span class="number">0.15</span> <span class="list">(<span class="number">0.86</span> <span class="list">(<span class="number">0.89</span> <span class="number">87</span> <span class="number">42</span>)</span> <span class="list">(<span class="number">0.43</span> <span class="number">85</span> <span class="number">58</span>)</span>)</span> <span class="list">(<span class="number">0.98</span> <span class="number">44</span> <span class="list">(<span class="number">0.48</span> <span class="number">34</span> <span class="number">28</span>)</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.84</span> <span class="number">81</span> <span class="number">60</span>)</span>)</span>)</span> <span class="number">28</span>)</span> <span class="number">16</span>)</span>)</span> <span class="list">(<span class="number">0.84</span> <span class="list">(<span class="number">0.21</span> <span class="number">34</span> <span class="list">(<span class="number">0.78</span> <span class="list">(<span class="number">0.76</span> <span class="list">(<span class="number">0.51</span> <span class="number">82</span> <span class="list">(<span class="number">0.07</span> <span class="list">(<span class="number">0.78</span> <span class="list">(<span class="number">0.52</span> <span class="list">(<span class="number">0.65</span> <span class="number">51</span> <span class="number">58</span>)</span> <span class="number">12</span>)</span> <span class="list">(<span class="number">0.05</span> <span class="number">52</span> <span class="list">(<span class="number">0.98</span> <span class="number">0</span> <span class="number">30</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.01</span> <span class="number">27</span> <span class="number">3</span>)</span>)</span>)</span> <span class="list">(<span class="number">1.00</span> <span class="number">15</span> <span class="list">(<span class="number">0.53</span> <span class="list">(<span class="number">0.91</span> <span class="list">(<span class="number">0.38</span> <span class="number">62</span> <span class="list">(<span class="number">0.75</span> <span class="number">92</span> <span class="number">69</span>)</span>)</span> <span class="list">(<span class="number">0.85</span> <span class="number">53</span> <span class="list">(<span class="number">0.84</span> <span class="number">92</span> <span class="number">83</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.70</span> <span class="list">(<span class="number">0.12</span> <span class="list">(<span class="number">0.24</span> <span class="number">23</span> <span class="number">83</span>)</span> <span class="number">58</span>)</span> <span class="list">(<span class="number">0.62</span> <span class="number">56</span> <span class="number">38</span>)</span>)</span>)</span>)</span>)</span> <span class="number">36</span>)</span>)</span> <span class="list">(<span class="number">0.66</span> <span class="number">41</span> <span class="number">13</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.94</span> <span class="list">(<span class="number">0.47</span> <span class="number">30</span> <span class="number">56</span>)</span> <span class="list">(<span class="number">0.78</span> <span class="number">6</span> <span class="list">(<span class="number">0.45</span> <span class="list">(<span class="number">0.45</span> <span class="number">15</span> <span class="number">94</span>)</span> <span class="list">(<span class="number">0.77</span> <span class="list">(<span class="number">0.57</span> <span class="number">25</span> <span class="list">(<span class="number">0.33</span> <span class="number">66</span> <span class="number">12</span>)</span>)</span> <span class="list">(<span class="number">0.66</span> <span class="number">74</span> <span class="list">(<span class="number">0.82</span> <span class="list">(<span class="number">0.14</span> <span class="number">75</span> <span class="number">50</span>)</span> <span class="list">(<span class="number">0.22</span> <span class="number">45</span> <span class="number">43</span>)</span>)</span>)</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.66</span> <span class="list">(<span class="number">0.58</span> <span class="list">(<span class="number">0.85</span> <span class="number">75</span> <span class="number">26</span>)</span> <span class="number">45</span>)</span> <span class="list">(<span class="number">0.04</span> <span class="list">(<span class="number">0.94</span> <span class="number">82</span> <span class="list">(<span class="number">0.59</span> <span class="number">34</span> <span class="list">(<span class="number">0.02</span> <span class="list">(<span class="number">0.09</span> <span class="number">11</span> <span class="list">(<span class="number">0.31</span> <span class="list">(<span class="number">0.05</span> <span class="list">(<span class="number">0.92</span> <span class="list">(<span class="number">0.14</span> <span class="number">51</span> <span class="number">45</span>)</span> <span class="list">(<span class="number">0.47</span> <span class="number">25</span> <span class="number">46</span>)</span>)</span> <span class="number">6</span>)</span> <span class="number">5</span>)</span>)</span> <span class="number">33</span>)</span>)</span>)</span> <span class="list">(<span class="number">0.81</span> <span class="list">(<span class="number">0.09</span> <span class="number">15</span> <span class="list">(<span class="number">0.91</span> <span class="list">(<span class="number">0.77</span> <span class="list">(<span class="number">0.59</span> <span class="number">44</span> <span class="list">(<span class="number">0.57</span> <span class="list">(<span class="number">0.39</span> <span class="list">(<span class="number">0.81</span> <span class="number">18</span> <span class="number">75</span>)</span> <span class="list">(<span class="number">0.37</span> <span class="number">41</span> <span class="number">67</span>)</span>)</span> <span class="number">18</span>)</span>)</span> <span class="list">(<span class="number">0.77</span> <span class="list">(<span class="number">0.68</span> <span class="list">(<span class="number">0.71</span> <span class="list">(<span class="number">0.31</span> <span class="number">87</span> <span class="number">94</span>)</span> <span class="number">85</span>)</span> <span class="list">(<span class="number">0.00</span> <span class="number">35</span> <span class="list">(<span class="number">0.55</span> <span class="number">81</span> <span class="number">22</span>)</span>)</span>)</span> <span class="number">56</span>)</span>)</span> <span class="number">3</span>)</span>)</span> <span class="list">(<span class="number">0.43</span> <span class="number">7</span> <span class="list">(<span class="number">0.98</span> <span class="number">94</span> <span class="number">3</span>)</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="number">0.13</span> <span class="number">22</span> <span class="number">80</span>)</span></div><div class="line"><span class="list">(<span class="number">0.77</span> <span class="number">45</span> <span class="number">81</span>)</span></div><div class="line"><span class="list">(<span class="number">0.61</span> <span class="list">(<span class="number">0.21</span> <span class="list">(<span class="number">0.32</span> <span class="list">(<span class="number">0.32</span> <span class="list">(<span class="number">0.81</span> <span class="number">8</span> <span class="number">60</span>)</span> <span class="number">78</span>)</span> <span class="list">(<span class="number">0.19</span> <span class="list">(<span class="number">0.92</span> <span class="number">68</span> <span class="list">(<span class="number">0.56</span> <span class="list">(<span class="number">0.22</span> <span class="number">79</span> <span class="number">32</span>)</span> <span class="list">(<span class="number">0.32</span> <span class="number">72</span> <span class="number">63</span>)</span>)</span>)</span> <span class="number">41</span>)</span>)</span> <span class="list">(<span class="number">0.30</span> <span class="number">94</span> <span class="number">31</span>)</span>)</span> <span class="list">(<span class="number">0.80</span> <span class="number">59</span> <span class="number">33</span>)</span>)</span></div></pre></td></tr></table></figure>

<h2 id="參考範例輸出">參考範例輸出</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">7.00</div><div class="line">3.00</div><div class="line">5.60</div><div class="line">-<span class="ruby"><span class="number">1.00</span></span></div><div class="line">241.55</div><div class="line">-<span class="ruby"><span class="number">30.00</span></span></div><div class="line">32.05</div><div class="line">71.24</div><div class="line">25.80</div><div class="line">97.64</div><div class="line">-<span class="ruby"><span class="number">37.98</span></span></div><div class="line">153.38</div><div class="line">67.92</div><div class="line">35.81</div><div class="line">-<span class="ruby"><span class="number">10.21</span></span></div><div class="line">-<span class="ruby"><span class="number">17.66</span></span></div><div class="line">19.68</div><div class="line">60.84</div><div class="line">92.20</div><div class="line">30.61</div><div class="line">157.62</div><div class="line">-<span class="ruby"><span class="number">37.20</span></span></div><div class="line">88.74</div><div class="line">-<span class="ruby"><span class="number">48.46</span></span></div></pre></td></tr></table></figure>

<h1 id="Reference">Reference</h1>
<p><a href="http://www.ibm.com/developerworks/cn/linux/sdk/lex/" target="_blank" rel="external">Yacc 与 Lex 快速入门</a></p>
<h1 id="指導">指導</h1>
<p><a href="http://en.wikipedia.org/wiki/God" target="_blank" rel="external">Inker</a></p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1636" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/12/oj/uva/uva-1636/" class="article-date">
  <time datetime="2014-05-12T01:15:24.000Z" itemprop="datePublished">May 12 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/12/oj/uva/uva-1636/">UVa 1636 - Headshot</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/12/oj/uva/uva-1636/" data-id="whg12bzlp1zzrufk" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/12/oj/uva/uva-1636/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/概率/">概率</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>You have a revolver gun with a cylinder that has n chambers. Chambers are located in a circle on a cylinder. Each chamber can be empty or can contain a round. One chamber is aligned with the gun’s barrel. When trigger of the gun is pulled, the gun’s cylinder rotates, aligning the next chamber with the barrel, hammer strikes the round, making a shot by firing a bullet through the barrel. If the chamber is empty when the hammer strikes it, then there is no shot but just a <code>click</code>.</p>
<p>You have found a use for this gun. You are playing Russian Roulette with your friend. Your friend loads rounds into some chambers, randomly rotates the cylinder, aligning a random chamber with a gun’s barrel, puts the gun to his head and pulls the trigger. You hear <code>click</code> and nothing else — the chamber was empty and the gun did not shoot.</p>
<p>Now it is your turn to put the gun to your head and pull the trigger. You have a choice. You can either pull the trigger right away or you can randomly rotate the gun’s cylinder and then pull the trigger. What should you choose to maximize the chances of your survival? </p>
<h2 id="Input">Input</h2>
<p>The input file contains several datasets. A dataset contains a single line with a string of n digits <code>0</code> and <code>1</code> ( 2 &lt;= n &lt;= 100). This line of digits represents the pattern of rounds that were loaded into the gun’s chambers. <code>0</code> represent an empty chamber, <code>1</code> represent a loaded one. In this representation, when cylinder rotates before a shot, the next chamber to the right gets aligned with the barrel for a shot. Since the chambers are actually located on a circle, the first chamber in this string follows the last one. There is at least one <code>0</code> in this string.</p>
<h2 id="Output">Output</h2>
<p>For each dataset, write to the output file one of the following words (without quotes):</p>
<ul>
<li><code>SHOOT</code> — if pulling the trigger right away makes you less likely to be actually shot in the head with the bullet (more likely that the chamber will be empty).</li>
<li><code>ROTATE</code> — if randomly rotating the cylinder before pulling the trigger makes you less likely to be actually shot in the head with the bullet (more likely that the chamber will be empty).</li>
<li><code>EQUAL</code> — if both of the above choices are equal in terms of probability of being shot.</li>
</ul>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">0011</div><div class="line">0111</div><div class="line">000111</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="operator">EQUAL</span></div><div class="line">ROTATE</div><div class="line">SHOOT</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述：</strong></p>
<p>俄羅斯輪盤，現在與一位朋友一起玩這場遊戲，然而我們已經知道左輪手槍中的填彈資訊，剛聽到朋友按下扣板，但是沒有死。現在輪到你，請問要直接按？還是隨機轉一圈再按？</p>
<p><strong> 題目解法：</strong></p>
<p>不外乎地，我們要找到哪個機率高。</p>
<p>由於朋友按下沒死，也就是要考慮連續 2 個 <code>0</code> 的情況，下一個是 <code>0</code> 的機率為 <code>czero / zero</code></p>
<p>// 在前提為 0 的情況下，下一個為 0 的機率為何，也就是考慮 <code>00</code> 和 <code>01</code> 的情況下，<code>00</code> 的機率為何。<br>// czero 是連續為 0 的個數，zero 是 0 的個數 (同時也是 <code>00</code> <code>01</code> 的個數。)，n 是全部個數。</p>
<p>隨機轉一圈得到 <code>0</code> 的概率為 <code>zero / n</code>。</p>
<p>不小心把題目想太難，事實上這問題很簡單的。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(){</div><div class="line">	<span class="keyword">char</span> s[<span class="number">1024</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s) == <span class="number">1</span>){</div><div class="line">        <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s);</div><div class="line">        <span class="keyword">int</span> zero = <span class="number">0</span>, one = <span class="number">0</span>, czero = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; n ; i++ ){</div><div class="line">            <span class="keyword">if</span>(s[i] == <span class="string">'1'</span>) </div><div class="line">				<span class="keyword">continue</span>;</div><div class="line">            zero++;</div><div class="line">            <span class="keyword">if</span>(s[(i+<span class="number">1</span>)%n] == <span class="string">'0'</span>) czero++;</div><div class="line">        }</div><div class="line">        <span class="comment">// czero - zero * (zero / n)</span></div><div class="line">        <span class="keyword">if</span>(czero * n == zero * zero) </div><div class="line">			<span class="built_in">puts</span>(<span class="string">"EQUAL"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(czero * n &gt; zero * zero)</div><div class="line">			<span class="built_in">puts</span>(<span class="string">"SHOOT"</span>);</div><div class="line">        <span class="keyword">else</span> </div><div class="line">			<span class="built_in">puts</span>(<span class="string">"ROTATE"</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1644" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/12/oj/uva/uva-1644/" class="article-date">
  <time datetime="2014-05-12T01:05:18.000Z" itemprop="datePublished">May 12 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/12/oj/uva/uva-1644/">UVa 1644 - Prime Gap</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/12/oj/uva/uva-1644/" data-id="lqnhscofsjt0237b" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/12/oj/uva/uva-1644/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sieve/">sieve</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p> The sequence of n - 1 consecutive composite numbers (positive integers that are not prime and not equal to 1) lying between two successive prime numbers p and p + n is called a prime gap of length n . For example, 〈24, 25, 26, 27, 28〉 between 23 and 29 is a prime gap of length 6.</p>
<p>Your mission is to write a program to calculate, for a given positive integer k , the length of the prime gap that contains k . For convenience, the length is considered 0 in case no prime gap contains k .</p>
<h2 id="Input">Input</h2>
<p>The input is a sequence of lines each of which contains a single positive integer. Each positive integer is greater than 1 and less than or equal to the 100000th prime number, which is 1299709. The end of the input is indicated by a line containing a single zero.</p>
<h2 id="Output">Output</h2>
<p>The output should be composed of lines each of which contains a single non-negative integer. It is the length of the prime gap that contains the corresponding positive integer in the input if it is a composite number, or `0’ otherwise. No other characters should occur in the output.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">10 </div><div class="line">11 </div><div class="line">27 </div><div class="line">2 </div><div class="line">492170 </div><div class="line">0</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">4 </div><div class="line">0 </div><div class="line">6 </div><div class="line">0 </div><div class="line">114</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述：</strong></p>
<p>找該數字左右相鄰的兩個質數差值。</p>
<p><strong> 題目解法：</strong></p>
<p>線性篩法 (sieve)。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> LL long long</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> maxL (1300000&gt;&gt;5)+1</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> GET(x) (mark[x&gt;&gt;5]&gt;&gt;(x&amp;31)&amp;1)</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> SET(x) (mark[x&gt;&gt;5] |= 1&lt;&lt;(x&amp;31))</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> mark[maxL];</div><div class="line"><span class="keyword">int</span> anaP[<span class="number">30</span>], at = <span class="number">0</span>;</div><div class="line"><span class="keyword">void</span> sieve() {</div><div class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, j, k;</div><div class="line">    SET(<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> n = <span class="number">1300000</span>;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">2</span>; i &lt; n; i++) {</div><div class="line">        <span class="keyword">if</span>(!GET(i)) {</div><div class="line">            <span class="keyword">for</span>(k = n/i, j = i*k; k &gt;= i; k--, j -= i)</div><div class="line">                SET(j);</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line">main() {</div><div class="line">    sieve();</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) {</div><div class="line">    	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = n; GET(i); i++, ret++);</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = n; GET(i) &amp;&amp; i &gt; <span class="number">0</span>; i--, ret++);</div><div class="line">    	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-10378" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/10/oj/uva/uva-10378/" class="article-date">
  <time datetime="2014-05-10T06:28:27.000Z" itemprop="datePublished">May 10 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/10/oj/uva/uva-10378/">UVa 10378 - Complex Numbers</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/10/oj/uva/uva-10378/" data-id="eej4why9ma9ei2ft" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/10/oj/uva/uva-10378/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/複數/">複數</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Numbers of the form a±bi are called complex numbers (Where i = √(-1)). In this problem you will have to find all the values of (a±bi)<sup>1/n</sup>. </p>
<h2 id="Input">Input</h2>
<p>The input file contains several lines of input. Each line has two parts. The first part will contain a complex number of the form a±bi and the second part will contain an integer n (0 &lt; n &lt;=100). Here a and b are integer numbers and 0 &lt;= |a|, |b|&lt;100. Input is terminated by end of file.</p>
<h2 id="Output">Output</h2>
<p>For each line of input you should produce n+2 lines of output. The description of output for each line of input is given in the next paragraph:</p>
<p>First line contains the case number as shown in the sample output. Next n lines should contain the n-th roots of the input complex number. The printed complex numbers should be of the form x±yi, where x and y are floating point numbers rounded upto three digits after the decimal point. Note that there is no space between the operators and operands. The roots are sorted according to descending order of their real part and then according to the descending order of their imaginary part. When the printed value of x or y is 0.000, it should be interpreted as positive zero. So you should never print something like “-0.000”. After all these outputs print a blank line. </p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">3</span>+<span class="number">4</span><span class="built_in">i</span> <span class="number">2</span></div><div class="line"><span class="number">5</span>-<span class="number">4</span><span class="built_in">i</span> <span class="number">3</span></div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Case 1:</div><div class="line">2.000+1.000i</div><div class="line">-<span class="ruby"><span class="number">2.000</span>-<span class="number">1.000</span>i</span></div><div class="line"></div><div class="line">Case 2:</div><div class="line">1.810-0.414i</div><div class="line">-<span class="ruby"><span class="number">0</span>.<span class="number">546</span>+<span class="number">1.775</span>i</span></div><div class="line">-<span class="ruby"><span class="number">1.264</span>-<span class="number">1.361</span>i</span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>問虛數 <code>a+bi</code> 的 n 次根號的結果，並且根據實數由大至小、虛數由大至小的字典順序輸出。</p>
<p><strong> 題目解法： </strong></p>
<p>先算出 <code>a+bi</code> 所占有的角度 <code>theta</code>，得到 <code>(theta + 2 * pi * i / n)</code> 是每一個根的角度，因為根據角度疊加原理得到 <code>(theta + 2 * pi * i / n) ^ n = theta + 2 * pi * i ＝ theta</code>，但是這題的困難是在於 如何避免 <code>-0.000</code> 的輸出。</p>
<p>原本錯誤排序的寫法</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">bool cmp(Point <span class="literal">a</span>, Point b) {</div><div class="line">	<span class="keyword">if</span>(fabs(<span class="literal">a</span>.x - b.x) &gt; eps)</div><div class="line">		<span class="keyword">return</span> <span class="literal">a</span>.x &lt; b.x<span class="comment">;</span></div><div class="line">	<span class="keyword">return</span> <span class="literal">a</span>.y &lt; b.y<span class="comment">;</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>應更正為如下代碼，如果要問我為什麼，現在還沒有仔細地理解，照理來說應該是差不多的。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">bool cmp(Point <span class="literal">a</span>, Point b) {</div><div class="line">	<span class="keyword">if</span>(fabs(<span class="literal">a</span>.x - b.x) &gt; eps)</div><div class="line">		<span class="keyword">return</span> <span class="literal">a</span>.x &lt; b.x<span class="comment">;</span></div><div class="line">	<span class="keyword">if</span>(fabs(<span class="literal">a</span>.y - b.y) &gt; eps)</div><div class="line">		<span class="keyword">return</span> <span class="literal">a</span>.y &lt; b.y<span class="comment">;</span></div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span><span class="comment">;</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>之前是想利用 <code>sprintf(buffer, &quot;%+.3lf%+.3lf&quot;, a, b);</code> 去檢查 <code>+0.000</code> 和 <code>-0.000</code>，這種寫法有點太過了，不過應該也是可行的。</p>
<figure class="highlight"><figcaption><span>lang: cpp</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdlib.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> eps 1e-6</span></div><div class="line"><span class="keyword">bool</span> cmp(pair&lt;<span class="keyword">double</span>, <span class="keyword">double</span>&gt; a, pair&lt;<span class="keyword">double</span>, <span class="keyword">double</span>&gt; b) {</div><div class="line">	<span class="keyword">if</span>(<span class="built_in">fabs</span>(a.first - b.first) &gt; eps)</div><div class="line">		<span class="keyword">return</span> a.first &gt; b.first;</div><div class="line">	<span class="keyword">if</span>(<span class="built_in">fabs</span>(a.second - b.second) &lt; eps)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	<span class="keyword">return</span> a.second &gt; b.second;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">    <span class="keyword">char</span> s[<span class="number">50</span>];</div><div class="line">    <span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(-<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> n, i, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">double</span> a, b;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s %d"</span>, s, &amp;n) == <span class="number">2</span>) {</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">sscanf</span>(s, <span class="string">"%lf+%lfi"</span>, &amp;a, &amp;b) == <span class="number">2</span>)</div><div class="line">            {}</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">sscanf</span>(s, <span class="string">"%lf-%lfi"</span>, &amp;a, &amp;b), b = -b;</div><div class="line">        <span class="keyword">double</span> theta = <span class="built_in">atan2</span>(b, a);</div><div class="line">        <span class="keyword">double</span> k = <span class="built_in">pow</span>(<span class="built_in">sqrt</span>(a*a+b*b), <span class="number">1.0</span>/n);</div><div class="line">        <span class="keyword">double</span> px, py;</div><div class="line">        pair&lt;<span class="keyword">double</span>, <span class="keyword">double</span>&gt; D[<span class="number">128</span>];</div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">            px = k*<span class="built_in">cos</span>((theta + i*<span class="number">2</span>*pi)/n);</div><div class="line">            py = k*<span class="built_in">sin</span>((theta + i*<span class="number">2</span>*pi)/n);</div><div class="line">            D[i] = make_pair(px, py);</div><div class="line">        }</div><div class="line">        sort(D, D+n, cmp);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>, ++cases);</div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">        	<span class="keyword">if</span>(<span class="built_in">fabs</span>(D[i].first) &lt; <span class="number">0.0005</span>)	D[i].first = <span class="number">0</span>;</div><div class="line">        	<span class="keyword">if</span>(<span class="built_in">fabs</span>(D[i].second) &lt; <span class="number">0.0005</span>)	D[i].second = <span class="number">0</span>;</div><div class="line">        	<span class="built_in">printf</span>(<span class="string">"%.3lf%+.3lfi\n"</span>, D[i].first, D[i].second);</div><div class="line">        }</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1572" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/07/oj/uva/uva-1572/" class="article-date">
  <time datetime="2014-05-06T23:46:52.000Z" itemprop="datePublished">May 7 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/07/oj/uva/uva-1572/">UVa 1572 - Self-Assembly</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/07/oj/uva/uva-1572/" data-id="d770r56dm9nhak1j" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/07/oj/uva/uva-1572/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/環/">環</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Automatic Chemical Manufacturing is experimenting with a process called self-assembly. In this process, molecules with natural asonity for each other are mixed together in a solution and allowed to spon-taneously assemble themselves into larger structures. But there is one problem: sometimes molecules assemble themselves into a structure of unbounded size, which gums up the machinery.</p>
<p>You must write a program to decide whether a given collection of molecules can be assembled into a structure of unbounded size. You should make two simplifying assumptions: 1) the problem is restricted to two dimensions, and 2) each molecule in the collection is represented as a square. The four edges of the square represent the surfaces on which the molecule can connect to other compatible molecules.</p>
<p>In each test case, you will be given a set of molecule descriptions. Each type of molecule is described by four two-character connector labels that indicate how its edges can connect to the edges of other molecules. There are two types of connector labels:</p>
<ul>
<li>An uppercase letter ( A, …, Z ) followed by <code>+</code> or <code>.</code> Two edges are compatible if their labels have the same letter but different signs. For example, <code>A+</code> is compatible with <code>A</code> but is not compatible with <code>A+</code> or <code>B</code>. </li>
<li>Two zero digits <code>00</code>. An edge with this label is not compatible with any edge (not even with<br>another edge labeled <code>00</code>).</li>
</ul>
<p>Assume there is an unlimited supply of molecules of each type, which may be rotated and reected.<br>As the molecules assemble themselves into larger structures, the edges of two molecules may be adjacent to each other only if they are compatible. It is permitted for an edge, regardless of its connector label, to be connected to nothing (no adjacent molecule on that edge). Figure A.1 shows an example of three molecule types and a structure of bounded size that can be assembled from them (other bounded structures are also possible with this set of molecules).</p>
<h2 id="Input">Input</h2>
<p>The input consists of several test cases. A test case consists of two lines. The rst contains an integer n (1 &lt; n &lt; 40000) indicating the number of molecule types. The second line contains n eight-character strings, each describing a single type of molecule, separated by single spaces. Each string consists of four two-character connector labels representing the four edges of the molecule in clockwise order.</p>
<h2 id="Output">Output</h2>
<p>For each test case, display the word <code>unbounded</code> if the set of molecule types can generate a structure of unbounded size. Otherwise, display the word <code>bounded</code>.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">3</span></div><div class="line">A+<span class="number">00</span>A+A+ <span class="number">00</span>B+<span class="keyword">D</span>+A- B-<span class="keyword">C</span>+<span class="number">00</span><span class="keyword">C</span>+</div><div class="line"><span class="number">1</span></div><div class="line"><span class="keyword">K</span>+<span class="keyword">K</span>-Q+Q-</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="title">bounded</span></div><div class="line">unbounded</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述：</strong></p>
<p>分定數種分子，每一種分子有無限多個，問會不會產生無邊界的化合物，也就是可以一直串一直串下去。</p>
<p><strong> 題目解法：</strong></p>
<p>鏡射和旋轉不用去理會，對於建圖並沒有影響，而題目圖片中看起來是平面，但是事實上可以螺旋疊起。</p>
<p><img class="lazy" data-original="/img/uva1572sol.PNG" alt="img"></p>
<p>如上圖片所示，使用這種建照方式去找環，只要有環的情況就會有無邊界的化合物。</p>
<p>不考慮找到每一個化合物間的關係，這關係過於龐大，只考慮接口連接的關係。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> g[<span class="number">64</span>][<span class="number">64</span>];</div><div class="line"><span class="keyword">int</span> node(<span class="keyword">char</span> a, <span class="keyword">char</span> b) {</div><div class="line">	<span class="keyword">return</span> (a - <span class="string">'A'</span>) + (b == <span class="string">'+'</span> ? <span class="number">0</span> : <span class="number">26</span>);</div><div class="line">}</div><div class="line"><span class="keyword">int</span> rnode(<span class="keyword">char</span> a, <span class="keyword">char</span> b) {</div><div class="line">	<span class="keyword">return</span> (a - <span class="string">'A'</span>) + (b == <span class="string">'+'</span> ? <span class="number">26</span> : <span class="number">0</span>);</div><div class="line">}</div><div class="line"><span class="keyword">int</span> exist_cycle;</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="keyword">char</span> s[<span class="number">50</span>];</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) {</div><div class="line">		<span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="keyword">sizeof</span>(g));</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)	 {</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++) {</div><div class="line">					<span class="keyword">if</span>(j == k || s[<span class="number">2</span> * j] == <span class="string">'0'</span> || s[<span class="number">2</span> * k] == <span class="string">'0'</span>)</div><div class="line">						<span class="keyword">continue</span>;</div><div class="line">					<span class="keyword">int</span> x = node(s[<span class="number">2</span> * j], s[<span class="number">2</span> * j + <span class="number">1</span>]);</div><div class="line">					<span class="keyword">int</span> y = rnode(s[<span class="number">2</span> * k], s[<span class="number">2</span> * k + <span class="number">1</span>]);</div><div class="line">					g[x][y] = <span class="number">1</span>;</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">		exist_cycle = <span class="number">0</span>;</div><div class="line">		n = <span class="number">52</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++) {</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">					g[i][j] |= g[i][k]&amp;g[k][j];</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">			exist_cycle |= g[i][i];</div><div class="line">		<span class="built_in">puts</span>(exist_cycle ? <span class="string">"unbounded"</span> : <span class="string">"bounded"</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="comment">/*</span></div><div class="line">3</div><div class="line">A+00A+A+ 00B+D+A- B-C+00C+</div><div class="line">1</div><div class="line">K+K-Q+Q-</div><div class="line">*/</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-10040" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/06/oj/uva/uva-10040/" class="article-date">
  <time datetime="2014-05-06T00:01:21.000Z" itemprop="datePublished">May 6 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/06/oj/uva/uva-10040/">UVa 10040 - Ouroboros Snake</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/06/oj/uva/uva-10040/" data-id="zfqeoe1en4gvm3bc" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/06/oj/uva/uva-10040/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/尤拉迴路/">尤拉迴路</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最小表示法/">最小表示法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞迴改寫/">遞迴改寫</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Background">Background</h2>
<p>Ouroboros was a mythical snake in Ancient Egypt. It has its tail inside its mouth and continuously devours itself.</p>
<h2 id="Problem">Problem</h2>
<p>Ouroboros numbers are binary numbers of 2n bits that have the property of generating the whole set of numbers from 0 to 2n-1 as follows: To produce all of them we place the 2n bits wrapped in a circle so that the last bit goes before the first one. Then we can denote all 2n different strings with n bits starting each time with the next bit in the circle.</p>
<p>For example, for n=2 there are only four Ouroboros numbers. These are 0011, 0110, 1100 and 1001. For 0011, the following diagram and table depicts the process of finding all the bitstrings:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">k 	00110011... 	o(n</span>=<span class="string">2,k)</span></div><div class="line">0 	00 	0</div><div class="line">1 	 01 	1</div><div class="line">2 	  11 	3</div><div class="line">3 	   10 	2</div></pre></td></tr></table></figure>

<p>Your program will compute the function o(n,k), where n &gt; 0 and $0 \leq k &lt; 2^n$. This function calculates the k-th number inside the smallest Ouroboros number of size n-bits.</p>
<h2 id="Input">Input</h2>
<p>The input starts with a line containing the number of test cases. For each test case you will be given a line with two integers n (0 &lt; n &lt;22) and k ( 0 &lt;= k &lt; 2^n).</p>
<h2 id="Output">Output</h2>
<p>For every test case your output must evaluate the function o(n,k) and print the result on a line by itself.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">4 </div><div class="line">2 0</div><div class="line">2 1</div><div class="line">2 2</div><div class="line">2 3</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">0</div><div class="line">1</div><div class="line">3</div><div class="line">2</div></pre></td></tr></table></figure>

<h1 id="Solution">Solution</h1>
<p><strong> 題目描述：</strong></p>
<p>有一個 <code>2^n</code> 個 bits 的環，而這個環恰好任取連續 n 個會湊滿 <code>[0, 2^n - 1]</code>，現在找一個字典順序最小的環，接著詢問這個環的某一個位置開始的數值。</p>
<p><strong> 題目解法：</strong></p>
<p>當詢問 n bits 的結果時，可以把圖建成 <code>2^(n-1)</code> 個節點，每一個節點有兩條邊，邊上分別為 0, 1，也就是說只要繞過所有的邊，相當於產生所有 <code>2^n</code> 個數字。</p>
<p>由於每一個點的 <code>indegree = outdegree</code> 一定存在尤拉迴路，接著在有向圖中找到一條尤拉迴路即可。</p>
<p>至於找字典順序最小環，使用 <code>周源最小表示法</code> 來找，如果可以的話希望能在搜尋時順便找到字典順序最小的。這裡就沒有系不去探究了。</p>
<p>以下是一個最簡單的版本，但這個版本在生成尤拉迴路時會遭遇到 stackoverflow。</p>
<figure class="highlight"><figcaption><span>TLE version because of stack overflow</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><span class="keyword">char</span> g[<span class="number">1</span>&lt;&lt;<span class="number">21</span>][<span class="number">2</span>] = {};</div><div class="line"><span class="keyword">int</span> n, mask, highbit;</div><div class="line"><span class="keyword">char</span> <span class="keyword">order</span>[<span class="number">2</span>][<span class="number">1</span>&lt;&lt;<span class="number">21</span>], *p;</div><div class="line"><span class="keyword">void</span> dfs(<span class="keyword">int</span> node) {</div><div class="line">	<span class="keyword">int</span> prefix = node;</div><div class="line">	prefix &lt;&lt;= <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) {</div><div class="line">        <span class="keyword">if</span>(g[node][i]) {</div><div class="line">            g[node][i]--;</div><div class="line">            dfs((prefix|i)&amp;mask);</div><div class="line">    		*p = (i) +<span class="string">'0'</span>, p++;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="keyword">int</span> MinExp(const <span class="keyword">char</span> *s, const <span class="keyword">int</span> slen) {</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>, k = <span class="number">0</span>, x, y, tmp;</div><div class="line">    <span class="keyword">while</span>(i &lt; slen &amp;&amp; j &lt; slen &amp;&amp; k &lt; slen) {</div><div class="line">        x = i + k;</div><div class="line">        y = j + k;</div><div class="line">        <span class="keyword">if</span>(x &gt;= slen)    x -= slen;</div><div class="line">        <span class="keyword">if</span>(y &gt;= slen)    y -= slen;</div><div class="line">        <span class="keyword">if</span>(s[x] == s[y]) {</div><div class="line">            k++;</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span>(s[x] &gt; s[y]) {</div><div class="line">            i = j+<span class="number">1</span> &gt; i+k+<span class="number">1</span> ? j+<span class="number">1</span> : i+k+<span class="number">1</span>;</div><div class="line">            k = <span class="number">0</span>;</div><div class="line">            tmp = i, i = j, j = tmp;</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            j = i+<span class="number">1</span> &gt; j+k+<span class="number">1</span> ? i+<span class="number">1</span> : j+k+<span class="number">1</span>;</div><div class="line">            k = <span class="number">0</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> i;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> testcase, K;</div><div class="line">	scanf(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">	<span class="keyword">while</span>(testcase--) {</div><div class="line">		scanf(<span class="string">"%d %d"</span>, &amp;n, &amp;K);</div><div class="line">		mask = (<span class="number">1</span>&lt;&lt;(n-<span class="number">1</span>)) - <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = (<span class="number">1</span>&lt;&lt;(n-<span class="number">1</span>)) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {</div><div class="line">			g[i][<span class="number">0</span>]++;</div><div class="line">			g[i][<span class="number">1</span>]++;</div><div class="line">		}</div><div class="line">		p = <span class="keyword">order</span>[<span class="number">0</span>];</div><div class="line">		dfs(<span class="number">0</span>);</div><div class="line">		*p = <span class="string">'\0'</span>, p++;</div><div class="line">		<span class="keyword">int</span> len = strlen(<span class="keyword">order</span>[<span class="number">0</span>]);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = len - <span class="number">1</span>, j = <span class="number">0</span>; i &gt;= <span class="number">0</span>; i--, j++)</div><div class="line">			<span class="keyword">order</span>[<span class="number">1</span>][i] = <span class="keyword">order</span>[<span class="number">0</span>][j];</div><div class="line">		<span class="keyword">order</span>[<span class="number">1</span>][len] = <span class="string">'\0'</span>;</div><div class="line">		<span class="keyword">int</span> o1 = MinExp(<span class="keyword">order</span>[<span class="number">0</span>], len);</div><div class="line">		<span class="keyword">int</span> o2 = MinExp(<span class="keyword">order</span>[<span class="number">1</span>], len);</div><div class="line">		<span class="keyword">int</span> f = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">			<span class="keyword">if</span>(<span class="keyword">order</span>[<span class="number">0</span>][(o1 + i)%len] != <span class="keyword">order</span>[<span class="number">1</span>][(o2 + i)%len]) {</div><div class="line">				f = <span class="keyword">order</span>[<span class="number">0</span>][(o1 + i)%len] &gt; <span class="keyword">order</span>[<span class="number">1</span>][(o2 + i)%len];</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">			ret = ret &lt;&lt; <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(f == <span class="number">0</span>) {</div><div class="line">				ret |= <span class="keyword">order</span>[<span class="number">0</span>][(o1 + i + K)%len] - <span class="string">'0'</span>;</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				ret |= <span class="keyword">order</span>[<span class="number">1</span>][(o2 + i + K)%len] - <span class="string">'0'</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		printf(<span class="string">"%d\n"</span>, ret);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>由於上述程式在走訪尤拉迴路時，由於深度過深而造成 <code>stackoverflow</code> 因此需要局部改寫成手動的 stack。通常主機只支持 10 萬到 20 萬之間的深度，這題最慘會到 100 萬。</p>
<p>並且將答案預建出來，如果沒有預建表會導致 <code>Time limit</code>，我以為只有少數幾筆，真是大錯特錯了。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#include &lt;stdio.h&gt;</span></div><div class="line"><span class="comment">#include &lt;string.h&gt;</span></div><div class="line"><span class="comment">#include &lt;stack&gt;</span></div><div class="line"><span class="comment">#include &lt;algorithm&gt;</span></div><div class="line">using namespace std;</div><div class="line">char g[<span class="number">1</span>&lt;&lt;<span class="number">21</span>][<span class="number">2</span>] = {};</div><div class="line"><span class="keyword">int</span> n, mask;</div><div class="line">char order[<span class="number">2</span>][<span class="number">1</span>&lt;&lt;<span class="number">21</span>], *p;</div><div class="line">char ouroboros[<span class="number">22</span>][<span class="number">1</span>&lt;&lt;<span class="number">21</span>];</div><div class="line"><span class="keyword">int</span> olen[<span class="number">22</span>];</div><div class="line">void dfs(<span class="keyword">int</span> node) {</div><div class="line">	stack&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; stk;</div><div class="line">	pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; <span class="keyword">state</span>;</div><div class="line">	<span class="keyword">int</span> line;	</div><div class="line">	stk.<span class="keyword">push</span>(make_pair(node, <span class="number">0</span>));</div><div class="line">	<span class="keyword">while</span>(!stk.empty()) {</div><div class="line">		<span class="keyword">state</span> = stk.top(), stk.<span class="keyword">pop</span>();</div><div class="line">		node = <span class="keyword">state</span>.first, line = <span class="keyword">state</span>.second&amp;<span class="number">3</span>;</div><div class="line">		<span class="keyword">if</span>(line == <span class="number">0</span>) {</div><div class="line">			<span class="keyword">int</span> prefix = node &lt;&lt; <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(g[node][<span class="number">0</span>]) {</div><div class="line">				g[node][<span class="number">0</span>]--;</div><div class="line">				stk.<span class="keyword">push</span>(make_pair(node, <span class="number">1</span>|<span class="number">8</span>));</div><div class="line">				stk.<span class="keyword">push</span>(make_pair((prefix|<span class="number">0</span>)&amp;mask, <span class="number">0</span>));</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				stk.<span class="keyword">push</span>(make_pair(node, <span class="number">1</span>));</div><div class="line">			}</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span>(line == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">if</span>(<span class="keyword">state</span>.second&amp;<span class="number">8</span>) {</div><div class="line">    			*p = (<span class="number">0</span>) +<span class="string">'0'</span>, p++;</div><div class="line">			}</div><div class="line">			<span class="keyword">int</span> prefix = node &lt;&lt; <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(g[node][<span class="number">1</span>]) {</div><div class="line">				g[node][<span class="number">1</span>]--;</div><div class="line">				stk.<span class="keyword">push</span>(make_pair(node, <span class="number">2</span>|<span class="number">8</span>));</div><div class="line">				stk.<span class="keyword">push</span>(make_pair((prefix|<span class="number">1</span>)&amp;mask, <span class="number">0</span>));</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				stk.<span class="keyword">push</span>(make_pair(node, <span class="number">2</span>));</div><div class="line">			}</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">if</span>(<span class="keyword">state</span>.second&amp;<span class="number">8</span>) {</div><div class="line">    			*p = (<span class="number">1</span>) +<span class="string">'0'</span>, p++;</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="keyword">int</span> MinExp(const char *<span class="keyword">s</span>, const <span class="keyword">int</span> slen) {</div><div class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>, k = <span class="number">0</span>, <span class="keyword">x</span>, <span class="keyword">y</span>, tmp;</div><div class="line">    <span class="keyword">while</span>(i &lt; slen &amp;&amp; j &lt; slen &amp;&amp; k &lt; slen) {</div><div class="line">        <span class="keyword">x</span> = i + k;</div><div class="line">        <span class="keyword">y</span> = j + k;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">x</span> &gt;= slen)    <span class="keyword">x</span> -= slen;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">y</span> &gt;= slen)    <span class="keyword">y</span> -= slen;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">s</span>[<span class="keyword">x</span>] == <span class="keyword">s</span>[<span class="keyword">y</span>]) {</div><div class="line">            k++;</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">s</span>[<span class="keyword">x</span>] &gt; <span class="keyword">s</span>[<span class="keyword">y</span>]) {</div><div class="line">            i = j+<span class="number">1</span> &gt; i+k+<span class="number">1</span> ? j+<span class="number">1</span> : i+k+<span class="number">1</span>;</div><div class="line">            k = <span class="number">0</span>;</div><div class="line">            tmp = i, i = j, j = tmp;</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            j = i+<span class="number">1</span> &gt; j+k+<span class="number">1</span> ? i+<span class="number">1</span> : j+k+<span class="number">1</span>;</div><div class="line">            k = <span class="number">0</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> i;</div><div class="line">}</div><div class="line">void build() {</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> n = <span class="number">1</span>; n &lt; <span class="number">22</span>; n++) {</div><div class="line">		mask = (<span class="number">1</span>&lt;&lt;(n-<span class="number">1</span>)) - <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = (<span class="number">1</span>&lt;&lt;(n-<span class="number">1</span>)) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {</div><div class="line">			g[i][<span class="number">0</span>]++;</div><div class="line">			g[i][<span class="number">1</span>]++;</div><div class="line">		}</div><div class="line">		p = order[<span class="number">0</span>];</div><div class="line">		dfs(<span class="number">0</span>);</div><div class="line">		*p = <span class="string">'\0'</span>, p++;</div><div class="line">		<span class="keyword">int</span> len = strlen(order[<span class="number">0</span>]);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = len - <span class="number">1</span>, j = <span class="number">0</span>; i &gt;= <span class="number">0</span>; i--, j++)</div><div class="line">			order[<span class="number">1</span>][i] = order[<span class="number">0</span>][j];</div><div class="line">		order[<span class="number">1</span>][len] = <span class="string">'\0'</span>;</div><div class="line">		<span class="keyword">int</span> o1 = MinExp(order[<span class="number">0</span>], len);</div><div class="line">		<span class="keyword">int</span> o2 = MinExp(order[<span class="number">1</span>], len);</div><div class="line">		<span class="keyword">int</span> f = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">			<span class="keyword">if</span>(order[<span class="number">0</span>][(o1 + i)<span class="variable">%len</span>] != order[<span class="number">1</span>][(o2 + i)<span class="variable">%len</span>]) {</div><div class="line">				f = order[<span class="number">0</span>][(o1 + i)<span class="variable">%len</span>] &gt; order[<span class="number">1</span>][(o2 + i)<span class="variable">%len</span>];</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">			<span class="keyword">if</span>(f == <span class="number">0</span>) {</div><div class="line">				ouroboros[n][i] = order[<span class="number">0</span>][(o1 + i)<span class="variable">%len</span>];</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				ouroboros[n][i] = order[<span class="number">1</span>][(o2 + i)<span class="variable">%len</span>];</div><div class="line">			}</div><div class="line">		}</div><div class="line">		olen[n] = len;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> testcase, K;</div><div class="line">	build();</div><div class="line">	scanf(<span class="string">"<span class="variable">%d</span>"</span>, &amp;testcase);</div><div class="line">	<span class="keyword">while</span>(testcase--) {</div><div class="line">		scanf(<span class="string">"<span class="variable">%d</span> <span class="variable">%d</span>"</span>, &amp;n, &amp;K);</div><div class="line">		<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">			ret = ret &lt;&lt; <span class="number">1</span>;</div><div class="line">			ret |= ouroboros[n][(i + K)<span class="variable">%olen</span>[n]] - <span class="string">'0'</span>;</div><div class="line">		}</div><div class="line">		<span class="keyword">printf</span>(<span class="string">"<span class="variable">%d</span>\n"</span>, ret);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/categories/解題區/解題區-UVa/page/39/">&laquo; Prev</a><a class="page-number" href="/categories/解題區/解題區-UVa/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/38/">38</a><a class="page-number" href="/categories/解題區/解題區-UVa/page/39/">39</a><span class="page-number current">40</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/41/">41</a><a class="extend next" rel="next" href="/categories/解題區/解題區-UVa/page/41/">Next &raquo;</a>
    </nav>
  
</section>
          
            <aside id="sidebar">
  <div id="ukagaka_panel"></div>

  

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">46</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">449</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">409</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2015/04/20/2015-google-code-jam-1A/">
              
                <i class="icon-file-o"></i> 
              
            2015 Google Code Jam Round 1A</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1115/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1115 - Water Shortage</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1089/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1089 - Suffix-Replacement Grammars</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1084/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1084 - Deer-Proof Fence</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1080/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1080 - My Bad</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1078/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1078 - Steam Roller</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1076/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1076 - Password Suspects</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1063/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1063 - Marble Game</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1049/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1049 - Remember the A La Mode</a>
          </li>
        
          <li>
            <a class="text" href="/2015/04/20/uva-1048/">
              
                <i class="icon-file-o"></i> 
              
            UVa 1048 - Low Cost Air Travel</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget widget-background1">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮神"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="#" title=""><i class="icon-github-alt"></i> Can you translate world for me ?</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
</aside>

          
            
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://plus.google.com/u/0/108158678174364359204" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2015 Shiang-Yun Yang 
    </div>  

  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/picture" class="mobile-nav-link">Pictures</a>
  
    <a href="/works" class="mobile-nav-link">Works</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/jquery.lazyload.js" type="text/javascript"></script>

<script src="/js/jquery.als-1.6.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>